{"version":3,"file":"APC-dbg.controller.js","names":["BaseController","_interopRequireDefault","__BaseController","Constants","__Constants","Util","__Util","APC","extend","constructor","prototype","apply","arguments","local","folderTreeIcon","sap","ui","+
require","toUrl","fragmentId","apcModel","selectedApc","path","state","apcLog","entries","apcView","githubIcon","linkedinIcon","onInit","_onInit","BaseController.prototype.onInit.call","handleInit","getView","setModel","JSONModel","_handleInit","getGloba+
lModel","dataLoaded","setBusy","initModel","Device","support","websocket","MessageToast","show","onChoosePushChannelButtonPress","_onChoosePushChannelButtonPress","handleAddApc","onDisconnectPushChannelButtonPress","_onDisconnectPushChannelButtonPress","+
socket","close","onClearPushChannelButtonPress","_onClearPushChannelButtonPress","refreshApcLog","_handleAddApc","apcList","getOwnerComponent","requests","getPushChannels","component","dialogManager","pickApc","setTitle","ApplicationId","_initModel","mod+
el","getModel","metadataLoaded","setSizeLimit","SERVICE_QUERY_LIMIT","onConnectPushChannelButtonPress","_onConnectPushChannelButtonPress","Promise","resolve","reject","SapPcpWebSocket","attachMessage","event","push","participant","data","getParameters","+
timestamp","Date","toISOString","attachOpen","attachClose","attachError","error","Error","JSON","stringify","focusFeedInput","showError","getById","_getById","id","globalId","control","Core","byId","_refreshApcLog","refresh","refreshAggregation","onPostM+
essageButtonPress","_onPostMessageButtonPress","value","send","_focusFeedInput","focus","_setTitle","title"],"sources":["APC.controller.ts"],"sourcesContent":["import ODataModel from \"sap/ui/model/odata/v2/ODataModel\";\nimport BaseController from \"./B+
aseController\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport { PushChannelEntity } from \"../Types\";\nimport Constants from \"../Constants\";\nimport Device from \"sap/ui/Device\";\ni+
mport Control from \"sap/ui/core/Control\";\nimport Core from \"sap/ui/core/Core\";\nimport SapPcpWebSocket, {\n\tSapPcpWebSocket$MessageEvent,\n} from \"sap/ui/core/ws/SapPcpWebSocket\";\nimport { FeedInput$PostEvent } from \"sap/m/FeedInput\";\nimport +
Util from \"../util/Util\";\nimport Table from \"sap/m/Table\";\n/**\n * @namespace de.kernich.odpu.controller\n */\nexport default class APC extends BaseController {\n\tprivate local = {\n\t\tfolderTreeIcon: sap.ui.require.toUrl(\n\t\t\t\"de/kernich/odp+
u/img/folder-tree-light.svg\"\n\t\t),\n\t};\n\n\tpublic fragmentId: string = \"\";\n\tpublic apcModel = {\n\t\tselectedApc: {\n\t\t\tpath: \"\",\n\t\t},\n\t\tstate: \"disconnected\" as \"connected\" | \"disconnected\",\n\t};\n\tpublic apcLog: {\n\t\tentr+
ies: {\n\t\t\tparticipant: string;\n\t\t\tdata: string;\n\t\t\ttimestamp: string;\n\t\t}[];\n\t} = {\n\t\tentries: [],\n\t};\n\tprivate socket: SapPcpWebSocket | undefined;\n\tprivate apcView = {\n\t\tgithubIcon: sap.ui.require.toUrl(\"de/kernich/odpu/im+
g/github-brands.svg\"),\n\t\tlinkedinIcon: sap.ui.require.toUrl(\n\t\t\t\"de/kernich/odpu/img/linkedin-brands.svg\"\n\t\t),\n\t};\n\n\tonInit() {\n\t\tsuper.onInit();\n\t\tvoid this.handleInit();\n\n\t\tthis.getView().setModel(new JSONModel(this.apcModel+
, true), \"apcModel\");\n\t\tthis.getView().setModel(new JSONModel(this.apcLog, true), \"apcLog\");\n\t\tthis.getView().setModel(new JSONModel(this.apcView, true), \"apcView\");\n\t}\n\n\tprivate async handleInit() {\n\t\tawait this.getGlobalModel().data+
Loaded();\n\t\tthis.setBusy(true);\n\t\tawait this.initModel();\n\n\t\tthis.setBusy(false);\n\n\t\tif (!Device.support.websocket) {\n\t\t\tMessageToast.show(\"Note: WebSocket not supported\");\n\t\t}\n\t}\n\n\tonChoosePushChannelButtonPress() {\n\t\tvoid+
 this.handleAddApc();\n\t}\n\n\tonDisconnectPushChannelButtonPress() {\n\t\tthis.socket?.close();\n\t\tthis.apcModel.state = \"disconnected\";\n\t\tMessageToast.show(\"Disconnected from \" + this.apcModel.selectedApc.path);\n\t\tthis.apcModel.selectedApc+
 = {\n\t\t\tpath: \"\",\n\t\t};\n\t}\n\n\tonClearPushChannelButtonPress() {\n\t\tthis.apcLog.entries = [];\n\t\tthis.refreshApcLog();\n\t}\n\n\tprivate async handleAddApc() {\n\t\tthis.setBusy(true);\n\t\ttry {\n\t\t\tconst apcList = await this.getOwnerC+
omponent().requests.getPushChannels();\n\t\t\tconst selectedApc = await this.component.dialogManager.pickApc(apcList);\n\t\t\tthis.apcModel.selectedApc = selectedApc;\n\t\t\tthis.setTitle(selectedApc.ApplicationId);\n\t\t} finally {\n\t\t\tthis.setBusy(f+
alse);\n\t\t}\n\t}\n\n\tprivate async initModel() {\n\t\tconst model = this.getOwnerComponent().getModel() as ODataModel;\n\t\tawait model.metadataLoaded(true);\n\t\tmodel.setSizeLimit(Constants.SERVICE_QUERY_LIMIT);\n\t}\n\n\tasync onConnectPushChannelB+
uttonPress() {\n\t\tthis.setBusy(true);\n\t\ttry {\n\t\t\tawait new Promise<void>((resolve, reject) => {\n\t\t\t\tthis.socket = new SapPcpWebSocket(this.apcModel.selectedApc.path);\n\t\t\t\tthis.socket.attachMessage((event: SapPcpWebSocket$MessageEvent) +
=> {\n\t\t\t\t\tthis.apcLog.entries.push({\n\t\t\t\t\t\tparticipant: \"Server\",\n\t\t\t\t\t\tdata: event.getParameters().data,\n\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t});\n\t\t\t\t\tthis.refreshApcLog();\n\t\t\t\t});\n\t\t\t\tthis.s+
ocket.attachOpen(() => {\n\t\t\t\t\tthis.apcModel.state = \"connected\";\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t\tthis.socket.attachClose(() => {\n\t\t\t\t\tthis.apcModel.state = \"disconnected\";\n\t\t\t\t});\n\t\t\t\tthis.socket.attachError((error: +
Error) => {\n\t\t\t\t\treject(new Error(\"failed to connect: \" + JSON.stringify(error)));\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.focusFeedInput();\n\t\t\tMessageToast.show(\"Connected to \" + this.apcModel.selectedApc.path);\n\t\t} catch (error) {\n\t\t\tU+
til.showError(error);\n\t\t} finally {\n\t\t\tthis.setBusy(false);\n\t\t}\n\t}\n\n\tprivate getById(id: string): Control | undefined {\n\t\tconst fragmentId = this.fragmentId;\n\t\tconst globalId = `${fragmentId}--${id}`;\n\n\t\tconst control = Core.byId+
(globalId);\n\t\treturn control as Control;\n\t}\n\n\tpublic refreshApcLog() {\n\t\tthis.getView().getModel(\"apcLog\").refresh();\n\t\t(this.getById(\"idLogTable\") as Table).refreshAggregation(\"items\");\n\t}\n\n\tpublic onPostMessageButtonPress(event+
: FeedInput$PostEvent) {\n\t\tthis.apcLog.entries.push({\n\t\t\tparticipant: \"Client\",\n\t\t\tdata: event.getParameters().value,\n\t\t\ttimestamp: new Date().toISOString(),\n\t\t});\n\t\tthis.socket?.send(event.getParameters().value);\n\t\tthis.refresh+
ApcLog();\n\t\tthis.focusFeedInput();\n\t}\n\n\tpublic focusFeedInput() {\n\t\tthis.getById(\"idFeedInput\")?.focus();\n\t}\n\n\tpublic setTitle(title: string) {\n\t\tthrow new Error(\"Not implemented: \" + title);\n\t}\n}\n"],"mappings":";;;;;;QACOA,cAA+
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","ignoreList":[]}                                                                                                                                     