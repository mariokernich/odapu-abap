{"version":3,"file":"APC-dbg.controller.js","names":["BaseController","_interopRequireDefault","__BaseController","Constants","__Constants","Util","__Util","APC","extend","constructor","prototype","apply","arguments","local","folderTreeIcon","sap","ui","+
require","toUrl","fragmentId","apcModel","selectedApc","path","state","apcLog","entries","apcView","githubIcon","linkedinIcon","onInit","_onInit","BaseController.prototype.onInit.call","handleInit","getView","setModel","JSONModel","_handleInit","getGloba+
lModel","dataLoaded","setBusy","initModel","Device","support","websocket","MessageToast","show","onChoosePushChannelButtonPress","_onChoosePushChannelButtonPress","handleAddApc","onDisconnectPushChannelButtonPress","_onDisconnectPushChannelButtonPress","+
socket","close","onClearPushChannelButtonPress","_onClearPushChannelButtonPress","refreshApcLog","_handleAddApc","apcList","getApc","component","dialogManager","pickApc","setTitle","application_id","_initModel","model","getOwnerComponent","getModel","met+
adataLoaded","setSizeLimit","SERVICE_QUERY_LIMIT","onConnectPushChannelButtonPress","_onConnectPushChannelButtonPress","Promise","resolve","reject","SapPcpWebSocket","attachMessage","event","push","participant","data","getParameters","timestamp","Date","+
toISOString","attachOpen","attachClose","attachError","error","Error","JSON","stringify","focusFeedInput","showError","_getApc","read","success","results","urlParameters","$top","toString","getById","_getById","id","globalId","control","Core","byId","_re+
freshApcLog","refresh","refreshAggregation","onPostMessageButtonPress","_onPostMessageButtonPress","value","send","_focusFeedInput","focus","_setTitle","title"],"sources":["APC.controller.ts"],"sourcesContent":["import ODataModel from \"sap/ui/model/odat+
a/v2/ODataModel\";\nimport BaseController from \"./BaseController\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport { ApcEntity } from \"../Types\";\nimport Constants from \"../Constants\+
";\nimport Device from \"sap/ui/Device\";\nimport Control from \"sap/ui/core/Control\";\nimport Core from \"sap/ui/core/Core\";\nimport SapPcpWebSocket, {\n\tSapPcpWebSocket$MessageEvent,\n} from \"sap/ui/core/ws/SapPcpWebSocket\";\nimport { FeedInput$Po+
stEvent } from \"sap/m/FeedInput\";\nimport Util from \"../util/Util\";\nimport Table from \"sap/m/Table\";\n/**\n * @namespace de.kernich.odpu.controller\n */\nexport default class APC extends BaseController {\n\tprivate local = {\n\t\tfolderTreeIcon: s+
ap.ui.require.toUrl(\n\t\t\t\"de/kernich/odpu/img/folder-tree-light.svg\"\n\t\t),\n\t};\n\n\tpublic fragmentId: string = \"\";\n\tpublic apcModel = {\n\t\tselectedApc: {\n\t\t\tpath: \"\",\n\t\t},\n\t\tstate: \"disconnected\" as \"connected\" | \"disconn+
ected\",\n\t};\n\tpublic apcLog: {\n\t\tentries: {\n\t\t\tparticipant: string;\n\t\t\tdata: string;\n\t\t\ttimestamp: string;\n\t\t}[];\n\t} = {\n\t\tentries: [],\n\t};\n\tprivate socket: SapPcpWebSocket | undefined;\n\tprivate apcView = {\n\t\tgithubIco+
n: sap.ui.require.toUrl(\"de/kernich/odpu/img/github-brands.svg\"),\n\t\tlinkedinIcon: sap.ui.require.toUrl(\n\t\t\t\"de/kernich/odpu/img/linkedin-brands.svg\"\n\t\t),\n\t};\n\n\tonInit() {\n\t\tsuper.onInit();\n\t\tvoid this.handleInit();\n\n\t\tthis.ge+
tView().setModel(new JSONModel(this.apcModel, true), \"apcModel\");\n\t\tthis.getView().setModel(new JSONModel(this.apcLog, true), \"apcLog\");\n\t\tthis.getView().setModel(new JSONModel(this.apcView, true), \"apcView\");\n\t}\n\n\tprivate async handleIn+
it() {\n\t\tawait this.getGlobalModel().dataLoaded();\n\t\tthis.setBusy(true);\n\t\tawait this.initModel();\n\n\t\tthis.setBusy(false);\n\n\t\tif (!Device.support.websocket) {\n\t\t\tMessageToast.show(\"Note: WebSocket not supported\");\n\t\t}\n\t}\n\n\t+
onChoosePushChannelButtonPress() {\n\t\tvoid this.handleAddApc();\n\t}\n\n\tonDisconnectPushChannelButtonPress() {\n\t\tthis.socket?.close();\n\t\tthis.apcModel.state = \"disconnected\";\n\t\tMessageToast.show(\"Disconnected from \" + this.apcModel.selec+
tedApc.path);\n\t\tthis.apcModel.selectedApc = {\n\t\t\tpath: \"\",\n\t\t};\n\t}\n\n\tonClearPushChannelButtonPress() {\n\t\tthis.apcLog.entries = [];\n\t\tthis.refreshApcLog();\n\t}\n\n\tprivate async handleAddApc() {\n\t\tthis.setBusy(true);\n\t\ttry {+
\n\t\t\tconst apcList = await this.getApc();\n\t\t\tconst selectedApc = await this.component.dialogManager.pickApc(apcList);\n\t\t\tthis.apcModel.selectedApc = selectedApc;\n\t\t\tthis.setTitle(selectedApc.application_id);\n\t\t} finally {\n\t\t\tthis.se+
tBusy(false);\n\t\t}\n\t}\n\n\tprivate async initModel() {\n\t\tconst model = this.getOwnerComponent().getModel() as ODataModel;\n\t\tawait model.metadataLoaded(true);\n\t\tmodel.setSizeLimit(Constants.SERVICE_QUERY_LIMIT);\n\t}\n\n\tasync onConnectPushC+
hannelButtonPress() {\n\t\tthis.setBusy(true);\n\t\ttry {\n\t\t\tawait new Promise<void>((resolve, reject) => {\n\t\t\t\tthis.socket = new SapPcpWebSocket(this.apcModel.selectedApc.path);\n\t\t\t\tthis.socket.attachMessage((event: SapPcpWebSocket$Message+
Event) => {\n\t\t\t\t\tthis.apcLog.entries.push({\n\t\t\t\t\t\tparticipant: \"Server\",\n\t\t\t\t\t\tdata: event.getParameters().data,\n\t\t\t\t\t\ttimestamp: new Date().toISOString(),\n\t\t\t\t\t});\n\t\t\t\t\tthis.refreshApcLog();\n\t\t\t\t});\n\t\t\t\+
tthis.socket.attachOpen(() => {\n\t\t\t\t\tthis.apcModel.state = \"connected\";\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t\tthis.socket.attachClose(() => {\n\t\t\t\t\tthis.apcModel.state = \"disconnected\";\n\t\t\t\t});\n\t\t\t\tthis.socket.attachError((+
error: Error) => {\n\t\t\t\t\treject(new Error(\"failed to connect: \" + JSON.stringify(error)));\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.focusFeedInput();\n\t\t\tMessageToast.show(\"Connected to \" + this.apcModel.selectedApc.path);\n\t\t} catch (error) {\n+
\t\t\tUtil.showError(error);\n\t\t} finally {\n\t\t\tthis.setBusy(false);\n\t\t}\n\t}\n\n\tprivate async getApc(): Promise<ApcEntity[]> {\n\t\tconst model = this.getOwnerComponent().getModel() as ODataModel;\n\t\treturn new Promise((resolve, reject) => {+
\n\t\t\tmodel.read(\"/apcSet\", {\n\t\t\t\tsuccess: (data: { results: ApcEntity[] }) => {\n\t\t\t\t\tresolve(data.results);\n\t\t\t\t},\n\t\t\t\terror: reject,\n\t\t\t\turlParameters: {\n\t\t\t\t\t$top: Constants.SERVICE_QUERY_LIMIT.toString(),\n\t\t\t\t+
},\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate getById(id: string): Control | undefined {\n\t\tconst fragmentId = this.fragmentId;\n\t\tconst globalId = `${fragmentId}--${id}`;\n\n\t\tconst control = Core.byId(globalId);\n\t\treturn control as Control;\n\t}\n\+
n\tpublic refreshApcLog() {\n\t\tthis.getView().getModel(\"apcLog\").refresh();\n\t\t(this.getById(\"idLogTable\") as Table).refreshAggregation(\"items\");\n\t}\n\n\tpublic onPostMessageButtonPress(event: FeedInput$PostEvent) {\n\t\tthis.apcLog.entries.p+
ush({\n\t\t\tparticipant: \"Client\",\n\t\t\tdata: event.getParameters().value,\n\t\t\ttimestamp: new Date().toISOString(),\n\t\t});\n\t\tthis.socket?.send(event.getParameters().value);\n\t\tthis.refreshApcLog();\n\t\tthis.focusFeedInput();\n\t}\n\n\tpub+
lic focusFeedInput() {\n\t\tthis.getById(\"idFeedInput\")?.focus();\n\t}\n\n\tpublic setTitle(title: string) {\n\t\tthrow new Error(\"Not implemented: \" + title);\n\t}\n}\n"],"mappings":";;;;;;QACOA,cAAc,GAAAC,sBAAA,CAAAC,gBAAA;EAAA,MAIdC,SAAS,GAAAF,sBA+
AA,CAAAG,WAAA;EAAA,MAQTC,IAAI,GAAAJ,sBAAA,CAAAK,MAAA;EAEX;AACA;AACA;EAFA,MAGqBC,GAAG,GAASP,cAAc,CAAAQ,MAAA;IAAAC,WAAA,WAAAA,YAAA;MAAAT,cAAA,CAAAU,SAAA,CAAAD,WAAA,CAAAE,KAAA,OAAAC,SAAA;MAAA,KACtCC,KAAK,GAAG;QACfC,cAAc,EAAEC,GAAG,CAACC,EAAE,CAACC,OAAO,CAAC+
C,KAAK,CACnC,2CACD;MACD,CAAC;MAAA,KAEMC,UAAU,GAAW,EAAE;MAAA,KACvBC,QAAQ,GAAG;QACjBC,WAAW,EAAE;UACZC,IAAI,EAAE;QACP,CAAC;QACDC,KAAK,EAAE;MACR,CAAC;MAAA,KACMC,MAAM,GAMT;QACHC,OAAO,EAAE;MACV,CAAC;MAAA,KAEOC,OAAO,GAAG;QACjBC,UAAU,EAAEZ,GAAG,CAACC,EAAE,CAACC,+
OAAO,CAACC,KAAK,CAAC,uCAAuC,CAAC;QACzEU,YAAY,EAAEb,GAAG,CAACC,EAAE,CAACC,OAAO,CAACC,KAAK,CACjC,yCACD;MACD,CAAC;IAAA;IAEDW,MAAM,WAAAC,QAAA,EAAG;MACRC,oCAAA;MACA,KAAK,IAAI,CAACC,UAAU,CAAC,CAAC;MAEtB,IAAI,CAACC,OAAO,CAAC,CAAC,CAACC,QAAQ,CAAC,IAAIC,SAAS,CAAC+
,IAAI,CAACf,QAAQ,EAAE,IAAI,CAAC,EAAE,UAAU,CAAC;MACvE,IAAI,CAACa,OAAO,CAAC,CAAC,CAACC,QAAQ,CAAC,IAAIC,SAAS,CAAC,IAAI,CAACX,MAAM,EAAE,IAAI,CAAC,EAAE,QAAQ,CAAC;MACnE,IAAI,CAACS,OAAO,CAAC,CAAC,CAACC,QAAQ,CAAC,IAAIC,SAAS,CAAC,IAAI,CAACT,OAAO,EAAE,IAAI,CAAC,EA+
AE,SAAS,CAAC;IACtE,CAAC;IAEaM,UAAU,iBAAAI,YAAA,EAAG;MAC1B,MAAM,IAAI,CAACC,cAAc,CAAC,CAAC,CAACC,UAAU,CAAC,CAAC;MACxC,IAAI,CAACC,OAAO,CAAC,IAAI,CAAC;MAClB,MAAM,IAAI,CAACC,SAAS,CAAC,CAAC;MAEtB,IAAI,CAACD,OAAO,CAAC,KAAK,CAAC;MAEnB,IAAI,CAACE,MAAM,CAACC,OAAO,+
CAACC,SAAS,EAAE;QAC9BC,YAAY,CAACC,IAAI,CAAC,+BAA+B,CAAC;MACnD;IACD,CAAC;IAEDC,8BAA8B,WAAAC,gCAAA,EAAG;MAChC,KAAK,IAAI,CAACC,YAAY,CAAC,CAAC;IACzB,CAAC;IAEDC,kCAAkC,WAAAC,oCAAA,EAAG;MACpC,IAAI,CAACC,MAAM,EAAEC,KAAK,CAAC,CAAC;MACpB,IAAI,CAAChC,QAAQ,CAACG,KA+
AK,GAAG,cAAc;MACpCqB,YAAY,CAACC,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAACzB,QAAQ,CAACC,WAAW,CAACC,IAAI,CAAC;MACxE,IAAI,CAACF,QAAQ,CAACC,WAAW,GAAG;QAC3BC,IAAI,EAAE;MACP,CAAC;IACF,CAAC;IAED+B,6BAA6B,WAAAC,+BAAA,EAAG;MAC/B,IAAI,CAAC9B,MAAM,CAACC,OAAO,GAAG,EAAE;MACxB,+
IAAI,CAAC8B,aAAa,CAAC,CAAC;IACrB,CAAC;IAEaP,YAAY,iBAAAQ,cAAA,EAAG;MAC5B,IAAI,CAACjB,OAAO,CAAC,IAAI,CAAC;MAClB,IAAI;QACH,MAAMkB,OAAO,GAAG,MAAM,IAAI,CAACC,MAAM,CAAC,CAAC;QACnC,MAAMrC,WAAW,GAAG,MAAM,IAAI,CAACsC,SAAS,CAACC,aAAa,CAACC,OAAO,CAACJ,OAAO,CAAC;QAC+
vE,IAAI,CAACrC,QAAQ,CAACC,WAAW,GAAGA,WAAW;QACvC,IAAI,CAACyC,QAAQ,CAACzC,WAAW,CAAC0C,cAAc,CAAC;MAC1C,CAAC,SAAS;QACT,IAAI,CAACxB,OAAO,CAAC,KAAK,CAAC;MACpB;IACD,CAAC;IAEaC,SAAS,iBAAAwB,WAAA,EAAG;MACzB,MAAMC,KAAK,GAAG,IAAI,CAACC,iBAAiB,CAAC,CAAC,CAACC,QAAQ,C+
AAC,CAAe;MAC/D,MAAMF,KAAK,CAACG,cAAc,CAAC,IAAI,CAAC;MAChCH,KAAK,CAACI,YAAY,CAAClE,SAAS,CAACmE,mBAAmB,CAAC;IAClD,CAAC;IAEKC,+BAA+B,iBAAAC,iCAAA,EAAG;MACvC,IAAI,CAACjC,OAAO,CAAC,IAAI,CAAC;MAClB,IAAI;QACH,MAAM,IAAIkC,OAAO,CAAO,CAACC,OAAO,EAAEC,MAAM,KAAK;UAC+
5C,IAAI,CAACxB,MAAM,GAAG,IAAIyB,eAAe,CAAC,IAAI,CAACxD,QAAQ,CAACC,WAAW,CAACC,IAAI,CAAC;UACjE,IAAI,CAAC6B,MAAM,CAAC0B,aAAa,CAAEC,KAAmC,IAAK;YAClE,IAAI,CAACtD,MAAM,CAACC,OAAO,CAACsD,IAAI,CAAC;cACxBC,WAAW,EAAE,QAAQ;cACrBC,IAAI,EAAEH,KAAK,CAACI,aAAa,CAAC,CAAC+
,CAACD,IAAI;cAChCE,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;YACnC,CAAC,CAAC;YACF,IAAI,CAAC9B,aAAa,CAAC,CAAC;UACrB,CAAC,CAAC;UACF,IAAI,CAACJ,MAAM,CAACmC,UAAU,CAAC,MAAM;YAC5B,IAAI,CAAClE,QAAQ,CAACG,KAAK,GAAG,WAAW;YACjCmD,OAAO,CAAC,CAAC;UACV,CAAC,CAAC+
;UACF,IAAI,CAACvB,MAAM,CAACoC,WAAW,CAAC,MAAM;YAC7B,IAAI,CAACnE,QAAQ,CAACG,KAAK,GAAG,cAAc;UACrC,CAAC,CAAC;UACF,IAAI,CAAC4B,MAAM,CAACqC,WAAW,CAAEC,KAAY,IAAK;YACzCd,MAAM,CAAC,IAAIe,KAAK,CAAC,qBAAqB,GAAGC,IAAI,CAACC,SAAS,CAACH,KAAK,CAAC,CAAC,CAAC;UACjE,CAAC,+
CAAC;QACH,CAAC,CAAC;QACF,IAAI,CAACI,cAAc,CAAC,CAAC;QACrBjD,YAAY,CAACC,IAAI,CAAC,eAAe,GAAG,IAAI,CAACzB,QAAQ,CAACC,WAAW,CAACC,IAAI,CAAC;MACpE,CAAC,CAAC,OAAOmE,KAAK,EAAE;QACfpF,IAAI,CAACyF,SAAS,CAACL,KAAK,CAAC;MACtB,CAAC,SAAS;QACT,IAAI,CAAClD,OAAO,CAAC,KAAK+
,CAAC;MACpB;IACD,CAAC;IAEamB,MAAM,iBAAAqC,QAAA,EAAyB;MAC5C,MAAM9B,KAAK,GAAG,IAAI,CAACC,iBAAiB,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAe;MAC/D,OAAO,IAAIM,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;QACvCV,KAAK,CAAC+B,IAAI,CAAC,SAAS,EAAE;UACrBC,OAAO,EAAGhB,IAA8B,IAAK;YAC5CP+
,OAAO,CAACO,IAAI,CAACiB,OAAO,CAAC;UACtB,CAAC;UACDT,KAAK,EAAEd,MAAM;UACbwB,aAAa,EAAE;YACdC,IAAI,EAAEjG,SAAS,CAACmE,mBAAmB,CAAC+B,QAAQ,CAAC;UAC9C;QACD,CAAC,CAAC;MACH,CAAC,CAAC;IACH,CAAC;IAEOC,OAAO,WAAAC,SAACC,EAAU,EAAuB;MAChD,MAAMrF,UAAU,GAAG,IAAI,CAACA,UA+
AU;MAClC,MAAMsF,QAAQ,GAAG,GAAGtF,UAAU,KAAKqF,EAAE,EAAE;MAEvC,MAAME,OAAO,GAAGC,IAAI,CAACC,IAAI,CAACH,QAAQ,CAAC;MACnC,OAAOC,OAAO;IACf,CAAC;IAEMnD,aAAa,WAAAsD,eAAA,EAAG;MACtB,IAAI,CAAC5E,OAAO,CAAC,CAAC,CAACkC,QAAQ,CAAC,QAAQ,CAAC,CAAC2C,OAAO,CAAC,CAAC;MAC1C,+
IAAI,CAACR,OAAO,CAAC,YAAY,CAAC,CAAWS,kBAAkB,CAAC,OAAO,CAAC;IAClE,CAAC;IAEMC,wBAAwB,WAAAC,0BAACnC,KAA0B,EAAE;MAC3D,IAAI,CAACtD,MAAM,CAACC,OAAO,CAACsD,IAAI,CAAC;QACxBC,WAAW,EAAE,QAAQ;QACrBC,IAAI,EAAEH,KAAK,CAACI,aAAa,CAAC,CAAC,CAACgC,KAAK;QACjC/B,SAAS,EAAE+
,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;MACnC,CAAC,CAAC;MACF,IAAI,CAAClC,MAAM,EAAEgE,IAAI,CAACrC,KAAK,CAACI,aAAa,CAAC,CAAC,CAACgC,KAAK,CAAC;MAC9C,IAAI,CAAC3D,aAAa,CAAC,CAAC;MACpB,IAAI,CAACsC,cAAc,CAAC,CAAC;IACtB,CAAC;IAEMA,cAAc,WAAAuB,gBAAA,EAAG;MACvB,IAAI+
,CAACd,OAAO,CAAC,aAAa,CAAC,EAAEe,KAAK,CAAC,CAAC;IACrC,CAAC;IAEMvD,QAAQ,WAAAwD,UAACC,KAAa,EAAE;MAC9B,MAAM,IAAI7B,KAAK,CAAC,mBAAmB,GAAG6B,KAAK,CAAC;IAC7C;EAAC;EAAA,OAtKmBhH,GAAG;AAAA","ignoreList":[]}                                                         