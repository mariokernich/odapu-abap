{"version":3,"file":"APC-dbg.controller.js","names":["BaseController","_interopRequireDefault","__BaseController","Constants","__Constants","Util","__Util","APC","extend","constructor","prototype","apply","arguments","local","folderTreeIcon","sap","ui","+
require","toUrl","fragmentId","apcModel","selectedApc","path","state","apcLog","entries","apcView","githubIcon","linkedinIcon","onInit","_onInit","BaseController.prototype.onInit.call","handleInit","getView","setModel","JSONModel","_handleInit","getGloba+
lModel","dataLoaded","setBusy","initModel","Device","support","websocket","MessageToast","show","component","getText","onChoosePushChannelButtonPress","_onChoosePushChannelButtonPress","handleAddApc","onDisconnectPushChannelButtonPress","_onDisconnectPus+
hChannelButtonPress","socket","close","onClearPushChannelButtonPress","_onClearPushChannelButtonPress","refreshApcLog","_handleAddApc","apcList","getOwnerComponent","requests","getPushChannels","dialogManager","pickApc","getModel","setProperty","Path","s+
etTitle","ApplicationId","_initModel","model","metadataLoaded","setSizeLimit","SERVICE_QUERY_LIMIT","onConnectPushChannelButtonPress","_onConnectPushChannelButtonPress","Promise","resolve","reject","SapPcpWebSocket","attachMessage","event","push","partic+
ipant","data","getParameters","timestamp","Date","toISOString","attachOpen","attachClose","attachError","error","Error","JSON","stringify","focusFeedInput","showError","getById","_getById","id","globalId","control","Core","byId","_refreshApcLog","refresh+
","refreshAggregation","onPostMessageButtonPress","_onPostMessageButtonPress","value","send","_focusFeedInput","focus","_setTitle","title"],"sources":["APC.controller.ts"],"sourcesContent":["import ODataModel from \"sap/ui/model/odata/v2/ODataModel\";\ni+
mport BaseController from \"./BaseController\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport Constants from \"../Constants\";\nimport Device from \"sap/ui/Device\";\nimport Control from+
 \"sap/ui/core/Control\";\nimport Core from \"sap/ui/core/Core\";\nimport SapPcpWebSocket, {\n\tSapPcpWebSocket$MessageEvent,\n} from \"sap/ui/core/ws/SapPcpWebSocket\";\nimport { FeedInput$PostEvent } from \"sap/m/FeedInput\";\nimport Util from \"../uti+
l/Util\";\nimport Table from \"sap/m/Table\";\n/**\n * @namespace de.kernich.odpu.controller\n */\nexport default class APC extends BaseController {\n\tprivate local = {\n\t\tfolderTreeIcon: sap.ui.require.toUrl(\n\t\t\t\"de/kernich/odpu/img/folder-tree-+
light.svg\"\n\t\t),\n\t};\n\n\tpublic fragmentId: string = \"\";\n\tpublic apcModel = {\n\t\tselectedApc: {\n\t\t\tpath: \"\",\n\t\t},\n\t\tstate: \"disconnected\" as \"connected\" | \"disconnected\",\n\t};\n\tpublic apcLog: {\n\t\tentries: {\n\t\t\tpart+
icipant: string;\n\t\t\tdata: string;\n\t\t\ttimestamp: string;\n\t\t}[];\n\t} = {\n\t\tentries: [],\n\t};\n\tprivate socket: SapPcpWebSocket | undefined;\n\tprivate apcView = {\n\t\tgithubIcon: sap.ui.require.toUrl(\"de/kernich/odpu/img/github-brands.sv+
g\"),\n\t\tlinkedinIcon: sap.ui.require.toUrl(\n\t\t\t\"de/kernich/odpu/img/linkedin-brands.svg\"\n\t\t),\n\t};\n\n\tonInit() {\n\t\tsuper.onInit();\n\t\tvoid this.handleInit();\n\n\t\tthis.getView()?.setModel(new JSONModel(this.apcModel, true), \"apcMod+
el\");\n\t\tthis.getView()?.setModel(new JSONModel(this.apcLog, true), \"apcLog\");\n\t\tthis.getView()?.setModel(new JSONModel(this.apcView, true), \"apcView\");\n\t}\n\n\tprivate async handleInit() {\n\t\tawait this.getGlobalModel().dataLoaded();\n\t\t+
this.setBusy(true);\n\t\tawait this.initModel();\n\n\t\tthis.setBusy(false);\n\n\t\tif (!Device.support.websocket) {\n\t\t\tMessageToast.show(this.component.getText(\"msg.noSocketSupport\"));\n\t\t}\n\t}\n\n\tonChoosePushChannelButtonPress() {\n\t\tvoid +
this.handleAddApc();\n\t}\n\n\tonDisconnectPushChannelButtonPress() {\n\t\tthis.socket?.close();\n\t\tthis.apcModel.state = \"disconnected\";\n\t\tMessageToast.show(this.component.getText(\"msg.apcDisconnected\", [this.apcModel.selectedApc.path]));\n\t\t+
this.apcModel.selectedApc = {\n\t\t\tpath: \"\",\n\t\t};\n\t}\n\n\tonClearPushChannelButtonPress() {\n\t\tthis.apcLog.entries = [];\n\t\tthis.refreshApcLog();\n\t}\n\n\tprivate async handleAddApc() {\n\t\tthis.setBusy(true);\n\t\ttry {\n\t\t\tconst apcLi+
st = await this.getOwnerComponent().requests.getPushChannels();\n\t\t\tconst selectedApc = await this.component.dialogManager.pickApc(apcList);\n\t\t\t(this.getView()?.getModel(\"apcModel\") as JSONModel).setProperty(\"/selectedApc/path\", selectedApc.Pa+
th);\n\t\t\tthis.setTitle(selectedApc.ApplicationId);\n\t\t} finally {\n\t\t\tthis.setBusy(false);\n\t\t}\n\t}\n\n\tprivate async initModel() {\n\t\tconst model = this.getOwnerComponent().getModel() as ODataModel;\n\t\tawait model.metadataLoaded(true);\n+
\t\tmodel.setSizeLimit(Constants.SERVICE_QUERY_LIMIT);\n\t}\n\n\tasync onConnectPushChannelButtonPress() {\n\t\tthis.setBusy(true);\n\t\ttry {\n\t\t\tawait new Promise<void>((resolve, reject) => {\n\t\t\t\tthis.socket = new SapPcpWebSocket(this.apcModel.+
selectedApc.path);\n\t\t\t\tthis.socket.attachMessage((event: SapPcpWebSocket$MessageEvent) => {\n\t\t\t\t\tthis.apcLog.entries.push({\n\t\t\t\t\t\tparticipant: \"Server\",\n\t\t\t\t\t\tdata: event.getParameters().data,\n\t\t\t\t\t\ttimestamp: new Date()+
.toISOString(),\n\t\t\t\t\t});\n\t\t\t\t\tthis.refreshApcLog();\n\t\t\t\t});\n\t\t\t\tthis.socket.attachOpen(() => {\n\t\t\t\t\tthis.apcModel.state = \"connected\";\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t\tthis.socket.attachClose(() => {\n\t\t\t\t\tth+
is.apcModel.state = \"disconnected\";\n\t\t\t\t});\n\t\t\t\tthis.socket.attachError((error: Error) => {\n\t\t\t\t\treject(new Error(\"failed to connect: \" + JSON.stringify(error)));\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.focusFeedInput();\n\t\t\tMessageToa+
st.show(this.component.getText(\"msg.apcConnected\", [this.apcModel.selectedApc.path]));\n\t\t} catch (error) {\n\t\t\tUtil.showError(error);\n\t\t} finally {\n\t\t\tthis.setBusy(false);\n\t\t}\n\t}\n\n\tprivate getById(id: string): Control | undefined {+
\n\t\tconst fragmentId = this.fragmentId;\n\t\tconst globalId = `${fragmentId}--${id}`;\n\n\t\tconst control = Core.byId(globalId);\n\t\treturn control as Control;\n\t}\n\n\tpublic refreshApcLog() {\n\t\tthis.getView()?.getModel(\"apcLog\")?.refresh();\n+
\t\t(this.getById(\"idLogTable\") as Table).refreshAggregation(\"items\");\n\t}\n\n\tpublic onPostMessageButtonPress(event: FeedInput$PostEvent) {\n\t\tthis.apcLog.entries.push({\n\t\t\tparticipant: \"Client\",\n\t\t\tdata: event.getParameters().value,\n+
\t\t\ttimestamp: new Date().toISOString(),\n\t\t});\n\t\tthis.socket?.send(event.getParameters().value);\n\t\tthis.refreshApcLog();\n\t\tthis.focusFeedInput();\n\t}\n\n\tpublic focusFeedInput() {\n\t\tthis.getById(\"idFeedInput\")?.focus();\n\t}\n\n\tpub+
lic setTitle(title: string) {\n\t\tthrow new Error(\"Not implemented: \" + title);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}                                                            