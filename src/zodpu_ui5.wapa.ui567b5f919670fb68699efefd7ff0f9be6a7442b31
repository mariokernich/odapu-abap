sap.ui.define(["sap/m/MessageToast", "sap/ui/base/ManagedObject", "../controller/dialog/AboutDialogController", "../controller/dialog/AddFilterDialogController", "../controller/dialog/AddHeaderDialogController", "../controller/dialog/AddSortDialogControl+
ler", "../controller/dialog/ConfirmationDialogController", "../controller/dialog/EditFilterDialogController", "../controller/dialog/PickApcDialogController", "../controller/dialog/PickCustomServiceDialogController", "../controller/dialog/PickServiceDialo+
gController", "../controller/dialog/ProjectListDialogController", "../controller/dialog/SaveProjectDialogController", "../controller/dialog/SelectProjectDialogController", "../controller/dialog/UpdateAvailableDialogController", "./DialogController", "./O+
DataRequests", "./Util"], function (MessageToast, ManagedObject, __AboutDialogController, __AddFilterDialogController, __AddHeaderDialogController, __AddSortDialogController, __ConfirmationDialogController, __EditFilterDialogController, __PickApcDialogCo+
ntroller, __PickCustomServiceDialogController, __PickServiceDialogController, __ProjectListDialogController, __SaveProjectDialogController, __SelectProjectDialogController, __UpdateAvailableDialogController, __DialogController, __ODataRequests, __Util) { 
  "use strict";                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
  function _interopRequireDefault(obj) {                                                                                                                                                                                                                       
    return obj && obj.__esModule && typeof obj.default !== "undefined" ? obj.default : obj;                                                                                                                                                                    
  }                                                                                                                                                                                                                                                            
  const AboutDialogController = _interopRequireDefault(__AboutDialogController);                                                                                                                                                                               
  const AddFilterDialogController = _interopRequireDefault(__AddFilterDialogController);                                                                                                                                                                       
  const AddHeaderDialogController = _interopRequireDefault(__AddHeaderDialogController);                                                                                                                                                                       
  const AddSortDialogController = _interopRequireDefault(__AddSortDialogController);                                                                                                                                                                           
  const ConfirmationDialogController = _interopRequireDefault(__ConfirmationDialogController);                                                                                                                                                                 
  const EditFilterDialogController = _interopRequireDefault(__EditFilterDialogController);                                                                                                                                                                     
  const PickApcDialogController = _interopRequireDefault(__PickApcDialogController);                                                                                                                                                                           
  const PickCustomServiceDialogController = _interopRequireDefault(__PickCustomServiceDialogController);                                                                                                                                                       
  const PickServiceDialogController = _interopRequireDefault(__PickServiceDialogController);                                                                                                                                                                   
  const ProjectListDialogController = _interopRequireDefault(__ProjectListDialogController);                                                                                                                                                                   
  const SaveProjectDialogController = _interopRequireDefault(__SaveProjectDialogController);                                                                                                                                                                   
  const SelectProjectDialogController = _interopRequireDefault(__SelectProjectDialogController);                                                                                                                                                               
  const UpdateAvailableDialogController = _interopRequireDefault(__UpdateAvailableDialogController);                                                                                                                                                           
  const DialogController = _interopRequireDefault(__DialogController);                                                                                                                                                                                         
  const ODataRequests = _interopRequireDefault(__ODataRequests);                                                                                                                                                                                               
  const Util = _interopRequireDefault(__Util);                                                                                                                                                                                                                 
  /**                                                                                                                                                                                                                                                          
   * @namespace de.kernich.odpu.util                                                                                                                                                                                                                           
   */                                                                                                                                                                                                                                                          
  const DialogManager = ManagedObject.extend("de.kernich.odpu.util.DialogManager", {                                                                                                                                                                           
    constructor: function _constructor(component) {                                                                                                                                                                                                            
      ManagedObject.prototype.constructor.call(this);                                                                                                                                                                                                          
      this.fragmentPath = "de.kernich.odpu.view.dialogs";                                                                                                                                                                                                      
      this.component = component;                                                                                                                                                                                                                              
      this.requests = new ODataRequests(component.getModel());                                                                                                                                                                                                 
    },                                                                                                                                                                                                                                                         
    pickApc: async function _pickApc(apc) {                                                                                                                                                                                                                    
      const {                                                                                                                                                                                                                                                  
        controller,                                                                                                                                                                                                                                            
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "PickApcDialog",                                                                                                                                                                                                                         
        controllerClass: PickApcDialogController                                                                                                                                                                                                               
      });                                                                                                                                                                                                                                                      
      const model = controller.getModel("dialog");                                                                                                                                                                                                             
      model.setProperty("/apc", apc);                                                                                                                                                                                                                          
      dialog.setTitle(`Select Push Channel (${apc.length})`);                                                                                                                                                                                                  
      dialog.open();                                                                                                                                                                                                                                           
      const result = await promise;                                                                                                                                                                                                                            
      return result.selectedApc;                                                                                                                                                                                                                               
    },                                                                                                                                                                                                                                                         
    pickService: async function _pickService() {                                                                                                                                                                                                               
      const {                                                                                                                                                                                                                                                  
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "PickServiceDialog",                                                                                                                                                                                                                     
        controllerClass: PickServiceDialogController                                                                                                                                                                                                           
      });                                                                                                                                                                                                                                                      
      dialog.open();                                                                                                                                                                                                                                           
      const result = await promise;                                                                                                                                                                                                                            
      return result.selectedService;                                                                                                                                                                                                                           
    },                                                                                                                                                                                                                                                         
    pickCustomService: async function _pickCustomService() {                                                                                                                                                                                                   
      const {                                                                                                                                                                                                                                                  
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "PickCustomServiceDialog",                                                                                                                                                                                                               
        controllerClass: PickCustomServiceDialogController                                                                                                                                                                                                     
      });                                                                                                                                                                                                                                                      
      dialog.open();                                                                                                                                                                                                                                           
      const result = await promise;                                                                                                                                                                                                                            
      return {                                                                                                                                                                                                                                                 
        ServicePath: result.servicePath.trim(),                                                                                                                                                                                                                
        ODataType: result.selectedType,                                                                                                                                                                                                                        
        Version: "",                                                                                                                                                                                                                                           
        ServiceName: "Custom Service",                                                                                                                                                                                                                         
        IsFavorite: false                                                                                                                                                                                                                                      
      };                                                                                                                                                                                                                                                       
    },                                                                                                                                                                                                                                                         
    showAddHeaderDialog: async function _showAddHeaderDialog() {                                                                                                                                                                                               
      const {                                                                                                                                                                                                                                                  
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "AddHeaderDialog",                                                                                                                                                                                                                       
        controllerClass: AddHeaderDialogController                                                                                                                                                                                                             
      });                                                                                                                                                                                                                                                      
      dialog.open();                                                                                                                                                                                                                                           
      const result = await promise;                                                                                                                                                                                                                            
      return {                                                                                                                                                                                                                                                 
        key: result.selectedType === "custom" ? result.selectedInputKey : result.selectedKey,                                                                                                                                                                  
        value: result.selectedValue                                                                                                                                                                                                                            
      };                                                                                                                                                                                                                                                       
    },                                                                                                                                                                                                                                                         
    addFilter: async function _addFilter(properties) {                                                                                                                                                                                                         
      const {                                                                                                                                                                                                                                                  
        controller,                                                                                                                                                                                                                                            
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "AddFilterDialog",                                                                                                                                                                                                                       
        controllerClass: AddFilterDialogController                                                                                                                                                                                                             
      });                                                                                                                                                                                                                                                      
      const model = controller.getModel("dialog");                                                                                                                                                                                                             
      model.setProperty("/properties", properties.filter(x => x.name.toLowerCase() !== "delete_mc" && x.name.toLowerCase() !== "update_mc" && x.name.toLowerCase() !== "create_mc").map(p => ({                                                                
        key: p.name,                                                                                                                                                                                                                                           
        text: p.name                                                                                                                                                                                                                                           
      })));                                                                                                                                                                                                                                                    
      dialog.open();                                                                                                                                                                                                                                           
      const result = await promise;                                                                                                                                                                                                                            
      return {                                                                                                                                                                                                                                                 
        property: result.selectedProperty,                                                                                                                                                                                                                     
        operator: result.selectedOperator,                                                                                                                                                                                                                     
        value: result.selectedValue                                                                                                                                                                                                                            
      };                                                                                                                                                                                                                                                       
    },                                                                                                                                                                                                                                                         
    editFilter: async function _editFilter(filter, properties) {                                                                                                                                                                                               
      const {                                                                                                                                                                                                                                                  
        controller,                                                                                                                                                                                                                                            
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "AddFilterDialog",                                                                                                                                                                                                                       
        controllerClass: EditFilterDialogController                                                                                                                                                                                                            
      });                                                                                                                                                                                                                                                      
      const model = controller.getModel("dialog");                                                                                                                                                                                                             
      model.setProperty("/properties", properties.filter(x => x.name.toLowerCase() !== "delete_mc" && x.name.toLowerCase() !== "update_mc" && x.name.toLowerCase() !== "create_mc").map(p => ({                                                                
        key: p.name,                                                                                                                                                                                                                                           
        text: p.name                                                                                                                                                                                                                                           
      })));                                                                                                                                                                                                                                                    
      model.setProperty("/selectedProperty", filter.property);                                                                                                                                                                                                 
      model.setProperty("/selectedOperator", filter.operator);                                                                                                                                                                                                 
      model.setProperty("/selectedValue", filter.value);                                                                                                                                                                                                       
      dialog.open();                                                                                                                                                                                                                                           
      const result = await promise;                                                                                                                                                                                                                            
      return {                                                                                                                                                                                                                                                 
        property: result.selectedProperty,                                                                                                                                                                                                                     
        operator: result.selectedOperator,                                                                                                                                                                                                                     
        value: result.selectedValue                                                                                                                                                                                                                            
      };                                                                                                                                                                                                                                                       
    },                                                                                                                                                                                                                                                         
    showConfirmationDialog: async function _showConfirmationDialog(message) {                                                                                                                                                                                  
      const {                                                                                                                                                                                                                                                  
        controller,                                                                                                                                                                                                                                            
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "ConfirmationDialog",                                                                                                                                                                                                                    
        controllerClass: ConfirmationDialogController                                                                                                                                                                                                          
      });                                                                                                                                                                                                                                                      
      const model = controller.getModel("dialog");                                                                                                                                                                                                             
      model.setProperty("/message", message);                                                                                                                                                                                                                  
      dialog.open();                                                                                                                                                                                                                                           
      const result = await promise;                                                                                                                                                                                                                            
      return result.confirmed;                                                                                                                                                                                                                                 
    },                                                                                                                                                                                                                                                         
    showUpdateAvailableDialog: async function _showUpdateAvailableDialog() {                                                                                                                                                                                   
      const info = this.component.getModel("info");                                                                                                                                                                                                            
      const infoEntity = info.getData();                                                                                                                                                                                                                       
      const {                                                                                                                                                                                                                                                  
        controller,                                                                                                                                                                                                                                            
        dialog                                                                                                                                                                                                                                                 
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "UpdateAvailableDialog",                                                                                                                                                                                                                 
        controllerClass: UpdateAvailableDialogController                                                                                                                                                                                                       
      });                                                                                                                                                                                                                                                      
      const model = controller.getModel("dialog");                                                                                                                                                                                                             
      model.setProperty("/currentVersion", infoEntity.Version);                                                                                                                                                                                                
      model.setProperty("/latestVersion", infoEntity.RemoteVersion);                                                                                                                                                                                           
      model.setProperty("/releaseNotes", infoEntity.LatestReleaseBody || "No release notes available.");                                                                                                                                                       
      dialog.open();                                                                                                                                                                                                                                           
    },                                                                                                                                                                                                                                                         
    showAboutDialog: async function _showAboutDialog() {                                                                                                                                                                                                       
      const info = this.component.getModel("info");                                                                                                                                                                                                            
      const infoEntity = info.getData();                                                                                                                                                                                                                       
      const {                                                                                                                                                                                                                                                  
        controller,                                                                                                                                                                                                                                            
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "AboutDialog",                                                                                                                                                                                                                           
        controllerClass: AboutDialogController                                                                                                                                                                                                                 
      });                                                                                                                                                                                                                                                      
      const model = controller.getModel("dialog");                                                                                                                                                                                                             
      model.setProperty("/Version", infoEntity.Version);                                                                                                                                                                                                       
      model.setProperty("/RemoteVersion", infoEntity.RemoteVersion);                                                                                                                                                                                           
      model.setProperty("/UpdateAvailable", infoEntity.UpdateAvailable);                                                                                                                                                                                       
      model.setProperty("/Logo", sap.ui.require.toUrl("de/kernich/odpu/img/odapu-logo.png"));                                                                                                                                                                  
      dialog.open();                                                                                                                                                                                                                                           
      return promise;                                                                                                                                                                                                                                          
    },                                                                                                                                                                                                                                                         
    selectProjectType: async function _selectProjectType() {                                                                                                                                                                                                   
      const {                                                                                                                                                                                                                                                  
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "SelectProjectType",                                                                                                                                                                                                                     
        controllerClass: SelectProjectDialogController                                                                                                                                                                                                         
      });                                                                                                                                                                                                                                                      
      dialog.open();                                                                                                                                                                                                                                           
      const result = await promise;                                                                                                                                                                                                                            
      return result.selectedType;                                                                                                                                                                                                                              
    },                                                                                                                                                                                                                                                         
    addSort: async function _addSort(properties) {                                                                                                                                                                                                             
      const {                                                                                                                                                                                                                                                  
        controller,                                                                                                                                                                                                                                            
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "AddSortDialog",                                                                                                                                                                                                                         
        controllerClass: AddSortDialogController                                                                                                                                                                                                               
      });                                                                                                                                                                                                                                                      
      const model = controller.getModel("dialog");                                                                                                                                                                                                             
      model.setProperty("/properties", properties.filter(x => x.name.toLowerCase() !== "delete_mc" && x.name.toLowerCase() !== "update_mc" && x.name.toLowerCase() !== "create_mc").map(p => ({                                                                
        key: p.name,                                                                                                                                                                                                                                           
        text: p.name                                                                                                                                                                                                                                           
      })));                                                                                                                                                                                                                                                    
      dialog.open();                                                                                                                                                                                                                                           
      const result = await promise;                                                                                                                                                                                                                            
      return {                                                                                                                                                                                                                                                 
        property: result.selectedProperty,                                                                                                                                                                                                                     
        direction: result.selectedDirection                                                                                                                                                                                                                    
      };                                                                                                                                                                                                                                                       
    },                                                                                                                                                                                                                                                         
    showXmlCodeEditor: async function _showXmlCodeEditor(client) {                                                                                                                                                                                             
      const {                                                                                                                                                                                                                                                  
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "XmlCodeEditor",                                                                                                                                                                                                                         
        controllerClass: class extends DialogController {                                                                                                                                                                                                      
          data = {                                                                                                                                                                                                                                             
            xml: "",                                                                                                                                                                                                                                           
            viewMode: "xml",                                                                                                                                                                                                                                   
            odataClient: client,                                                                                                                                                                                                                               
            entities: [],                                                                                                                                                                                                                                      
            functions: [],                                                                                                                                                                                                                                     
            actions: [],                                                                                                                                                                                                                                       
            complexTypes: []                                                                                                                                                                                                                                   
          };                                                                                                                                                                                                                                                   
          onInit() {                                                                                                                                                                                                                                           
            this.data.xml = Util.formatXml(client.getMetadataText());                                                                                                                                                                                          
            this.data.entities = client.getEntities() || [];                                                                                                                                                                                                   
            this.data.functions = client.getFunctions() || [];                                                                                                                                                                                                 
            this.data.actions = client.getActions() || [];                                                                                                                                                                                                     
            this.data.complexTypes = client.getComplexTypes() || [];                                                                                                                                                                                           
          }                                                                                                                                                                                                                                                    
          onEntityPreview() {                                                                                                                                                                                                                                  
            // The preview controls will automatically render the data                                                                                                                                                                                         
            // when the viewMode changes to "entity"                                                                                                                                                                                                           
          }                                                                                                                                                                                                                                                    
          onCopy() {                                                                                                                                                                                                                                           
            void Util.copy2Clipboard(this.data.xml);                                                                                                                                                                                                           
            MessageToast.show(this.getText("msg.copiedToClipboard"));                                                                                                                                                                                          
          }                                                                                                                                                                                                                                                    
          onDownload() {                                                                                                                                                                                                                                       
            void Util.download(this.data.xml, "metadata.xml");                                                                                                                                                                                                 
          }                                                                                                                                                                                                                                                    
        }                                                                                                                                                                                                                                                      
      });                                                                                                                                                                                                                                                      
      dialog.open();                                                                                                                                                                                                                                           
      return promise;                                                                                                                                                                                                                                          
    },                                                                                                                                                                                                                                                         
    showProjectListDialog: async function _showProjectListDialog() {                                                                                                                                                                                           
      const projects = await this.requests.getProjects();                                                                                                                                                                                                      
      const {                                                                                                                                                                                                                                                  
        controller,                                                                                                                                                                                                                                            
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "ProjectListDialog",                                                                                                                                                                                                                     
        controllerClass: ProjectListDialogController                                                                                                                                                                                                           
      });                                                                                                                                                                                                                                                      
      const model = controller.getModel("dialog");                                                                                                                                                                                                             
      model.setProperty("/projects", projects);                                                                                                                                                                                                                
      dialog.open();                                                                                                                                                                                                                                           
      const result = await promise;                                                                                                                                                                                                                            
      return result.selectedProject;                                                                                                                                                                                                                           
    },                                                                                                                                                                                                                                                         
    showSaveProjectDialog: async function _showSaveProjectDialog() {                                                                                                                                                                                           
      const {                                                                                                                                                                                                                                                  
        dialog,                                                                                                                                                                                                                                                
        promise                                                                                                                                                                                                                                                
      } = await this.createDialog({                                                                                                                                                                                                                            
        fragmentName: "SaveProjectDialog",                                                                                                                                                                                                                     
        controllerClass: SaveProjectDialogController                                                                                                                                                                                                           
      });                                                                                                                                                                                                                                                      
      dialog.open();                                                                                                                                                                                                                                           
      const result = await promise;                                                                                                                                                                                                                            
      return result.projectName;                                                                                                                                                                                                                               
    },                                                                                                                                                                                                                                                         
    getDialogId: function _getDialogId(params) {                                                                                                                                                                                                               
      const dialogId = `${this.getMetadata().getName().replace(/\./g, "")}--${params.fragmentName.replace(/\//g, "")}`;                                                                                                                                        
      if (params.id) {                                                                                                                                                                                                                                         
        return `${dialogId}--${params.id}`;                                                                                                                                                                                                                    
      }                                                                                                                                                                                                                                                        
      return dialogId;                                                                                                                                                                                                                                         
    },                                                                                                                                                                                                                                                         
    createDialog: async function _createDialog(options) {                                                                                                                                                                                                      
      const dialogName = options.id || options.fragmentName;                                                                                                                                                                                                   
      const dialogId = this.getDialogId(options);                                                                                                                                                                                                              
      const controller = new options.controllerClass();                                                                                                                                                                                                        
      const infoModel = this.component.getModel("info");                                                                                                                                                                                                       
      const i18nModel = this.component.getModel("i18n");                                                                                                                                                                                                       
      await controller.init({                                                                                                                                                                                                                                  
        path: this.fragmentPath + "/" + options.fragmentName,                                                                                                                                                                                                  
        name: dialogName,                                                                                                                                                                                                                                      
        id: dialogId,                                                                                                                                                                                                                                          
        dialogManager: this,                                                                                                                                                                                                                                   
        requests: this.requests,                                                                                                                                                                                                                               
        bundle: this.component.bundle                                                                                                                                                                                                                          
      });                                                                                                                                                                                                                                                      
      const promiseHelper = await controller.initPromise();                                                                                                                                                                                                    
      controller.dialog.setModel(i18nModel, "i18n");                                                                                                                                                                                                           
      controller.dialog.setModel(infoModel, "info");                                                                                                                                                                                                           
      controller.dialog.attachAfterOpen(() => {                                                                                                                                                                                                                
        controller.onAfterOpen();                                                                                                                                                                                                                              
      });                                                                                                                                                                                                                                                      
      controller.dialog.setEscapeHandler(() => {                                                                                                                                                                                                               
        controller.onCancel();                                                                                                                                                                                                                                 
      });                                                                                                                                                                                                                                                      
      controller.onInit();                                                                                                                                                                                                                                     
      return {                                                                                                                                                                                                                                                 
        controller: controller,                                                                                                                                                                                                                                
        dialog: controller.dialog,                                                                                                                                                                                                                             
        promise: promiseHelper.promise                                                                                                                                                                                                                         
      };                                                                                                                                                                                                                                                       
    }                                                                                                                                                                                                                                                          
  });                                                                                                                                                                                                                                                          
  return DialogManager;                                                                                                                                                                                                                                        
});                                                                                                                                                                                                                                                            
//# sourceMappingURL=DialogManager-dbg.js.map                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               