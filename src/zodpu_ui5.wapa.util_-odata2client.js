sap.ui.define(["sap/ui/model/odata/v2/ODataModel","./ODataHelper","sap/m/MessageBox","./Util"],function(e,t,a,r){"use strict";function n(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const s=n(t);const i=n(r);class m{constructor(t+
){this.serviceUrl=t;this.model=new e(t,{});this.model.attachRequestFailed({},e=>{const t=e.getParameters();const r=t.response.responseText;if(r.startsWith("<?xml")){const e=new DOMParser;const t=e.parseFromString(r,"text/xml");const n=t.getElementsByTagN+
ame("message")[0];if(n){a.error(n.textContent)}else{a.error("Unknown error occurred")}}else{const e=JSON.parse(r);a.error(e.error.message.value)}})}getActions(){return[]}destroy(){}async createEntity(e,t){await new Promise((a,r)=>{this.model.create(`/${e+
}`,t,{success:()=>a(),error:e=>r(e)})})}async getEntity(e,t){const a=this.model.createKey(`/${e}`,t);const r=await new Promise((e,t)=>{this.model.createBindingContext(a,undefined,{},a=>{if(a){e(a)}else{t(new Error("Failed to create binding context"))}},t+
rue)});return r.getObject()}async deleteEntity(e,t){const a=this.model.createKey(`/${e}`,t);await new Promise((e,t)=>{this.model.remove(a,{success:()=>e(),error:e=>t(e)})})}async initAsync(){try{await this.model.metadataLoaded(true)}catch(e){a.error("Fai+
led to load metadata of Service "+this.serviceUrl+":\n\nPlease check Backend configuration and try again.",{details:i.getErrorMessage(e)});throw e}this.metadataText=await s.getMetadataText(this.serviceUrl);this.metadataXml=s.parseMetadataXml(this.metadat+
aText)}getEntities(){const e=[];const t=Array.from(this.metadataXml.getElementsByTagName("EntitySet")).map(e=>({Name:e.getAttribute("Name"),EntityType:e.getAttribute("EntityType")}));for(const a of t){let t=a.EntityType;if(t.includes(".")){t=t.split(".")+
.pop()}const r=Array.from(this.metadataXml.getElementsByTagName("EntityType")).find(e=>e.getAttribute("Name")===t);const n=Array.from(r.getElementsByTagName("Property")).map(e=>({name:e.getAttribute("Name"),type:e.getAttribute("Type"),nullable:e.getAttri+
bute("Nullable"),maxLength:s.getMaxLength(e.getAttribute("MaxLength"))}));const i=r.getElementsByTagName("Key")[0];const m=Array.from(i.getElementsByTagName("PropertyRef")).map(e=>({name:e.getAttribute("Name"),type:n.find(t=>t.name===e.getAttribute("Name+
")).type,nullable:n.find(t=>t.name===e.getAttribute("Name")).nullable,maxLength:n.find(t=>t.name===e.getAttribute("Name")).maxLength}));e.push({name:a.Name,entityType:t,properties:n,keys:m})}return e.filter(e=>!e.name.startsWith("SAP__"))}getMetadataText+
(){return this.metadataText}getMetadataXml(){return this.metadataXml}getFunctions(){const e=Array.from(this.metadataXml.getElementsByTagName("FunctionImport")).map(e=>({Name:e.getAttribute("Name"),ReturnType:e.getAttribute("ReturnType"),EntitySet:e.getAt+
tribute("EntitySet"),HttpMethod:e.getAttribute("m:HttpMethod"),Parameters:Array.from(e.getElementsByTagName("Parameter")).map(e=>({name:e.getAttribute("Name"),type:e.getAttribute("Type"),nullable:e.getAttribute("Nullable"),maxLength:s.getMaxLength(e.getA+
ttribute("MaxLength"))}))}));return e.map(e=>({name:e.Name,returnType:e.ReturnType,entitySet:e.EntitySet,parameters:e.Parameters,method:e.HttpMethod}))}getModel(){return this.model}async readEntity(e){this.model.setHeaders(e.headers);return await new Pro+
mise((t,a)=>{this.model.read(`/${e.entityName}`,{success:e=>{t(e)},error:e=>{a(e)},filters:e.filters.length>0?e.filters:undefined,sorters:e.sorting.length>0?e.sorting:undefined,urlParameters:{$top:e.top.toString(),$skip:e.skip.toString()}})})}async execu+
teFunction(e){return await new Promise((t,a)=>{this.model.callFunction(`/${e.functionName}`,{urlParameters:e.parameters,method:e.method,success:e=>t(e),error:e=>a(e)})})}executeAction(e){throw new Error("Not implemented")}}return m});                     
//# sourceMappingURL=OData2Client.js.map                                                                                                                                                                                                                       