{"version":3,"file":"PickServiceDialogController.js","names":["DialogController","_interopRequireDefault","__DialogController","PickServiceDialogController","extend","constructor","prototype","apply","this","arguments","data","services","odataTypes","sea+
rchQuery","selectedODataType","selectedService","onInit","_onInit","key","text","getText","handleInit","async","_handleInit","dialog","setBusy","requests","getServices","model","getModel","setProperty","setTitle","length","onSearch","_onSearch","event","+
query","getParameter","toLowerCase","table","getElement","binding","getBinding","filter","Filter","filters","FilterOperator","Contains","and","filteredLength","getLength","onODataTypeChange","_onODataTypeChange","selectedKey","getKey","applyFilters","onR+
efresh","_onRefresh","handleRefresh","_handleRefresh","refresh","MessageToast","show","onChoose","_onChoose","selectedItem","getSelectedItem","bindingContext","getBindingContext","service","getObject","onConfirm","onCustomService","_onCustomService","dia+
logManager","pickCustomService","_applyFilters","push","EQ","onFavorite","_onFavorite","isFavorite","getSource","handleFavorite","_handleFavorite","markAsFavorite","servicePath","ServicePath"],"sources":["PickServiceDialogController.ts"],"sourcesContent"+
:["import DialogController from \"../../util/DialogController\";\nimport { ServiceEntity } from \"../../Types\";\nimport { SearchField$LiveChangeEvent } from \"sap/m/SearchField\";\nimport { Select$ChangeEvent } from \"sap/m/Select\";\nimport Filter from+
 \"sap/ui/model/Filter\";\nimport FilterOperator from \"sap/ui/model/FilterOperator\";\nimport ListBinding from \"sap/ui/model/ListBinding\";\nimport Table from \"sap/m/Table\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport Context from \"sap+
/ui/model/odata/v2/Context\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport { Button$PressEvent } from \"sap/m/Button\";\n\n/**\n * @namespace de.kernich.odpu.controller.dialog\n */\nexport default class PickServiceDialogController exte+
nds DialogController {\n\tdata = {\n\t\tservices: [] as ServiceEntity[],\n\t\todataTypes: [] as { key: string; text: string }[],\n\t\tsearchQuery: \"\",\n\t\tselectedODataType: \"ALL\",\n\t\tselectedService: null as ServiceEntity | null,\n\t};\n\n\tonIni+
t() {\n\t\tthis.data.odataTypes = [\n\t\t\t{ key: \"ALL\", text: this.getText(\"lbl.all\") },\n\t\t\t{ key: \"2\", text: \"2\" },\n\t\t\t{ key: \"4\", text: \"4\" },\n\t\t];\n\t\tvoid this.handleInit();\n\t}\n\n\tprivate async handleInit() {\n\t\tthis.di+
alog.setBusy(true);\n\t\ttry {\n\t\t\tconst services = await this.requests.getServices();\n\t\t\tconst model = this.getModel(\"dialog\") as JSONModel;\n\t\t\tmodel.setProperty(\"/services\", services);\n\t\t\tthis.dialog.setTitle(this.getText(\"dlg.title+
.selectService\") + ` (${services.length})`);\n\t\t} finally {\n\t\t\tthis.dialog.setBusy(false);\n\t\t}\n\t}\n\n\tonSearch(event: SearchField$LiveChangeEvent) {\n\t\tconst query = event.getParameter(\"newValue\")?.toLowerCase() ?? \"\";\n\t\tconst table+
 = this.getElement<Table>(\"idServicesTable\");\n\t\tconst binding = table.getBinding(\"items\") as ListBinding;\n\n\t\tbinding.filter(\n\t\t\tquery\n\t\t\t\t? new Filter({\n\t\t\t\t\t\tfilters: [\n\t\t\t\t\t\t\tnew Filter(\"ServiceName\", FilterOperator+
.Contains, query),\n\t\t\t\t\t\t\tnew Filter(\"ServicePath\", FilterOperator.Contains, query),\n\t\t\t\t\t\t],\n\t\t\t\t\t\tand: false,\n\t\t\t\t  })\n\t\t\t\t: []\n\t\t);\n\n\t\tconst filteredLength = binding ? binding.getLength() : 0;\n\t\tthis.dialog.+
setTitle(this.getText(\"dlg.title.selectService\") + ` (${filteredLength})`);\n\t}\n\n\tonODataTypeChange(event: Select$ChangeEvent) {\n\t\tconst selectedKey = event.getParameter(\"selectedItem\")?.getKey() ?? \"ALL\";\n\t\tthis.data.selectedODataType = +
selectedKey;\n\t\tthis.applyFilters();\n\t}\n\n\tonRefresh() {\n\t\tvoid this.handleRefresh();\n\t}\n\n\tasync handleRefresh() {\n\t\tthis.dialog.setBusy(true);\n\t\ttry {\n\t\t\tconst model = this.getModel(\"dialog\") as JSONModel;\n\t\t\tconst services+
 = await this.requests.getServices({ refresh: true });\n\t\t\tmodel.setProperty(\"/services\", services);\n\t\t\tMessageToast.show(this.getText(\"msg.servicesRefreshed\"));\n\t\t} finally {\n\t\t\tthis.dialog.setBusy(false);\n\t\t}\n\t}\n\n\tonChoose() {+
\n\t\tconst table = this.getElement<Table>(\"idServicesTable\");\n\t\tconst selectedItem = table.getSelectedItem();\n\n\t\tif (!selectedItem) {\n\t\t\tMessageToast.show(this.getText(\"msg.selectService\"));\n\t\t\treturn;\n\t\t}\n\n\t\tconst bindingConte+
xt = selectedItem.getBindingContext(\"dialog\") as Context;\n\t\tconst service = bindingContext.getObject() as ServiceEntity;\n\t\tthis.data.selectedService = service;\n\t\tthis.onConfirm();\n\t}\n\n\tasync onCustomService() {\n\t\ttry {\n\t\t\tconst ser+
vice = await this.dialogManager.pickCustomService();\n\t\t\tthis.data.selectedService = service;\n\t\t\tthis.onConfirm();\n\t\t} catch {\n\t\t\t// Ignore error as it's handled in pickCustomService\n\t\t}\n\t}\n\n\tprivate applyFilters() {\n\t\tconst tabl+
e = this.getElement<Table>(\"idServicesTable\");\n\t\tconst binding = table.getBinding(\"items\") as ListBinding;\n\t\tconst filters: Filter[] = [];\n\n\t\t// Add search filter if query exists\n\t\tif (this.data.searchQuery) {\n\t\t\tfilters.push(\n\t\t\+
t\tnew Filter(\n\t\t\t\t\t\"ServiceName\",\n\t\t\t\t\tFilterOperator.Contains,\n\t\t\t\t\tthis.data.searchQuery\n\t\t\t\t),\n\t\t\t\tnew Filter(\n\t\t\t\t\t\"ServicePath\",\n\t\t\t\t\tFilterOperator.Contains,\n\t\t\t\t\tthis.data.searchQuery\n\t\t\t\t)\n+
\t\t\t);\n\t\t}\n\n\t\t// Add OData type filter if not ALL\n\t\tif (this.data.selectedODataType !== \"ALL\") {\n\t\t\tfilters.push(\n\t\t\t\tnew Filter(\"ODataType\", FilterOperator.EQ, this.data.selectedODataType)\n\t\t\t);\n\t\t}\n\n\t\t// Apply combin+
ed filters\n\t\tbinding.filter(\n\t\t\tfilters.length > 0 ? new Filter({ filters: filters, and: true }) : []\n\t\t);\n\n\t\tconst filteredLength = binding ? binding.getLength() : 0;\n\t\tthis.dialog.setTitle(this.getText(\"dlg.title.selectService\") + ` +
(${filteredLength})`);\n\t}\n\n\tonFavorite(isFavorite: boolean, event: Button$PressEvent) {\n\t\tconst binding = event.getSource().getBindingContext(\"dialog\") as Context;\n\t\tconst service = binding.getObject() as ServiceEntity;\n\t\tvoid this.handle+
Favorite(service, isFavorite);\n\t}\n\n\tasync handleFavorite(service: ServiceEntity, isFavorite: boolean) {\n\t\tthis.dialog.setBusy(true);\n\t\ttry {\n\t\t\tawait this.requests.markAsFavorite({\n\t\t\t\tservicePath: service.ServicePath,\n\t\t\t\tisFavo+
rite: isFavorite,\n\t\t\t});\n\t\t\tawait this.handleRefresh();\n\t\t} finally {\n\t\t\tthis.dialog.setBusy(false);\n\t\t}\n\t}\n}\n"],"mappings":"6OAAOA,EAAgBC,EAAAC,GAavB,MAGqBC,EAAoCH,EAAgBI,OAAA,iEAAAC,YAAA,SAAAA,IAAAL,EAAAM,UAAAD,YAAAE,MAAAC,KAAAC,W+
AAAD,KACxEE,KAAO,CACNC,SAAU,GACVC,WAAY,GACZC,YAAa,GACbC,kBAAmB,MACnBC,gBAAiB,KACjB,EAEDC,OAAM,SAAAC,IACLT,KAAKE,KAAKE,WAAa,CACtB,CAAEM,IAAK,MAAOC,KAAMX,KAAKY,QAAQ,YACjC,CAAEF,IAAK,IAAKC,KAAM,KAClB,CAAED,IAAK,IAAKC,KAAM,WAEdX,KAAKa,YACX,EAEcA,WAAUC,eAAAC,+
IACvBf,KAAKgB,OAAOC,QAAQ,MACpB,IACC,MAAMd,QAAiBH,KAAKkB,SAASC,cACrC,MAAMC,EAAQpB,KAAKqB,SAAS,UAC5BD,EAAME,YAAY,YAAanB,GAC/BH,KAAKgB,OAAOO,SAASvB,KAAKY,QAAQ,2BAA6B,KAAKT,EAASqB,UAC9E,CAAC,QACAxB,KAAKgB,OAAOC,QAAQ,MACrB,CACD,EAEAQ,SAAQ,SAAAC,EAACC,GACR,MAA+
MC,EAAQD,EAAME,aAAa,aAAaC,eAAiB,GAC/D,MAAMC,EAAQ/B,KAAKgC,WAAkB,mBACrC,MAAMC,EAAUF,EAAMG,WAAW,SAEjCD,EAAQE,OACPP,EACG,IAAIQ,EAAO,CACXC,QAAS,CACR,IAAID,EAAO,cAAeE,EAAeC,SAAUX,GACnD,IAAIQ,EAAO,cAAeE,EAAeC,SAAUX,IAEpDY,IAAK,QAEL,IAGJ,MAAMC,EAAiBR,EAAUA,EAAQ+
S,YAAc,EACvD1C,KAAKgB,OAAOO,SAASvB,KAAKY,QAAQ,2BAA6B,KAAK6B,KACrE,EAEAE,kBAAiB,SAAAC,EAACjB,GACjB,MAAMkB,EAAclB,EAAME,aAAa,iBAAiBiB,UAAY,MACpE9C,KAAKE,KAAKI,kBAAoBuC,EAC9B7C,KAAK+C,cACN,EAEAC,UAAS,SAAAC,SACHjD,KAAKkD,eACX,EAEMA,cAAapC,eAAAqC,IAClBnD,KAAK+
gB,OAAOC,QAAQ,MACpB,IACC,MAAMG,EAAQpB,KAAKqB,SAAS,UAC5B,MAAMlB,QAAiBH,KAAKkB,SAASC,YAAY,CAAEiC,QAAS,OAC5DhC,EAAME,YAAY,YAAanB,GAC/BkD,EAAaC,KAAKtD,KAAKY,QAAQ,yBAChC,CAAC,QACAZ,KAAKgB,OAAOC,QAAQ,MACrB,CACD,EAEAsC,SAAQ,SAAAC,IACP,MAAMzB,EAAQ/B,KAAKgC,WAAkB+
,mBACrC,MAAMyB,EAAe1B,EAAM2B,kBAE3B,IAAKD,EAAc,CAClBJ,EAAaC,KAAKtD,KAAKY,QAAQ,sBAC/B,MACD,CAEA,MAAM+C,EAAiBF,EAAaG,kBAAkB,UACtD,MAAMC,EAAUF,EAAeG,YAC/B9D,KAAKE,KAAKK,gBAAkBsD,EAC5B7D,KAAK+D,WACN,EAEMC,gBAAelD,eAAAmD,IACpB,IACC,MAAMJ,QAAgB7D,KAAKkE,cAAcC,+
oBACzCnE,KAAKE,KAAKK,gBAAkBsD,EAC5B7D,KAAK+D,WACN,CAAE,MACD,CAEF,EAEQhB,aAAY,SAAAqB,IACnB,MAAMrC,EAAQ/B,KAAKgC,WAAkB,mBACrC,MAAMC,EAAUF,EAAMG,WAAW,SACjC,MAAMG,EAAoB,GAG1B,GAAIrC,KAAKE,KAAKG,YAAa,CAC1BgC,EAAQgC,KACP,IAAIjC,EACH,cACAE,EAAeC,SACfvC,KAAKE,KA+
AKG,aAEX,IAAI+B,EACH,cACAE,EAAeC,SACfvC,KAAKE,KAAKG,aAGb,CAGA,GAAIL,KAAKE,KAAKI,oBAAsB,MAAO,CAC1C+B,EAAQgC,KACP,IAAIjC,EAAO,YAAaE,EAAegC,GAAItE,KAAKE,KAAKI,mBAEvD,CAGA2B,EAAQE,OACPE,EAAQb,OAAS,EAAI,IAAIY,EAAO,CAAEC,QAASA,EAASG,IAAK,OAAU,IAGpE,MAAMC,EAAiB+
R,EAAUA,EAAQS,YAAc,EACvD1C,KAAKgB,OAAOO,SAASvB,KAAKY,QAAQ,2BAA6B,KAAK6B,KACrE,EAEA8B,WAAU,SAAAC,EAACC,EAAqB9C,GAC/B,MAAMM,EAAUN,EAAM+C,YAAYd,kBAAkB,UACpD,MAAMC,EAAU5B,EAAQ6B,iBACnB9D,KAAK2E,eAAed,EAASY,EACnC,EAEME,eAAc7D,eAAA8D,EAACf,EAAwBY,GAC5CzE,KAAKg+
B,OAAOC,QAAQ,MACpB,UACOjB,KAAKkB,SAAS2D,eAAe,CAClCC,YAAajB,EAAQkB,YACrBN,WAAYA,UAEPzE,KAAKkD,eACZ,CAAC,QACAlD,KAAKgB,OAAOC,QAAQ,MACrB,CACD,IAAC,OAxJmBtB,CAA2B","ignoreList":[]}                                                                               