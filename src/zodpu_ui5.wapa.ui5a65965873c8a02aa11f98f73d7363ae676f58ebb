{"version":3,"file":"DialogController-dbg.js","names":["DialogController","BaseObject","extend","constructor","prototype","apply","arguments","data","dialogId","dialog","_dialog","dialogManager","_dialogManager","value","requests","_requests","init","_in+
it","options","Promise","all","initDialog","initPromise","setModel","_setModel","model","modelName","getModel","_getModel","_initDialog","id","dialogName","name","createDialogFromFragment","path","controller","bundle","dialogModel","JSONModel","setBusyIn+
dicatorDelay","getElement","_getElement","el","Fragment","byId","Error","getText","_getText","key","_createDialogFromFragment","load","_initPromise","promiseHelper","createPromise","_createPromise","resolve","reject","promise","s","e","res","onConfirm","+
_onConfirm","close","destroy","onCancel","_onCancel","_resolve","_reject","reason","_destroy","BaseObject.prototype.destroy.call"],"sources":["DialogController.ts"],"sourcesContent":["import Dialog from \"sap/m/Dialog\";\nimport Fragment from \"sap/ui/co+
re/Fragment\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport Model from \"sap/ui/model/Model\";\nimport BaseObject from \"sap/ui/base/Object\";\nimport DialogManager from \"./DialogManager\";\nimport ODataRequests from \"./ODataRequests+
\";\nimport Control from \"sap/ui/core/Control\";\nimport ResourceBundle from \"sap/base/i18n/ResourceBundle\";\n\ntype PromiseHelper<T> = {\n    promise: Promise<T>;\n    resolve: (value: T) => void;\n    reject: (value: unknown) => void;\n};\n\n/**\n *+
 @namespace de.kernich.odpu.util\n */\nclass DialogController extends BaseObject {\n    public data = {};\n    public promiseHelper?: PromiseHelper<typeof this.data>;\n    public get dialog() {\n        return this._dialog;\n    }\n\n    public get dialo+
gManager() {\n        return this._dialogManager;\n    }\n\n    protected set dialog(value: Dialog) {\n        this._dialog = value;\n    }\n\n    private set dialogManager(value: DialogManager) {\n        this._dialogManager = value;\n    }\n\n    publi+
c set requests(value: ODataRequests) {\n        this._requests = value;\n    }\n\n    public get requests() {\n        return this._requests;\n    }\n\n    private dialogName?: string;\n    private dialogId = \"\";\n    private _dialog!: Dialog;\n    pri+
vate _dialogManager!: DialogManager;\n    private _requests!: ODataRequests;\n    private bundle!: ResourceBundle;\n    \n    async init(options: {\n        path: string;\n        name: string;\n        id: string;\n        dialogManager: DialogManager;\+
n        requests: ODataRequests;\n        bundle: ResourceBundle\n    }) {\n        return Promise.all([this.initDialog(options), this.initPromise()]);\n    }\n\n    public setModel(model: Model, modelName?: string) {\n        this.dialog.setModel(model+
, modelName);\n    }\n\n    public getModel(modelName?: string) {\n        return this.dialog?.getModel(modelName);\n    }\n\n    private async initDialog(options: {\n        path: string;\n        name: string;\n        id: string;\n        dialogManage+
r: DialogManager;\n        requests: ODataRequests;\n        bundle: ResourceBundle;\n    }): Promise<Dialog> {\n        let dialog = this.dialog;\n\n        this.dialogId = options.id;\n\n        if (!dialog) {\n\n            this.dialogName = options.n+
ame;\n            dialog = await this.createDialogFromFragment({\n                path: options.path,\n                id: options.id,\n                controller: this\n            });\n\n            this.dialog = dialog;\n            this.dialogManager+
 = options.dialogManager;\n            this.requests = options.requests;\n            this.bundle = options.bundle;\n            const dialogModel = new JSONModel(this.data, true);\n\n            this.setModel(dialogModel, \"dialog\");\n\n            dia+
log.setBusyIndicatorDelay(0);\n        }\n\n        return dialog;\n    }\n\n    public getElement<TType extends Control>(id: string): TType {\n        const el = Fragment.byId(this.dialogId, id) as TType;\n\n        if (!el) {\n            throw new Err+
or(`Element in dialog ${this.dialogId} w/ id ${id} not found`);\n        }\n\n        return el;\n    }\n\n    public getText(key: string): string {\n        return this.bundle.getText(key) ?? key;\n    }\n\n    private async createDialogFromFragment(opt+
ions: {\n        path: string;\n        controller: object;\n        id: string;\n    }): Promise<Dialog> {\n        return (await Fragment.load({\n            name: options.path,\n            controller: options.controller,\n            id: options.id\n+
        })) as Dialog;\n    }\n\n    public async initPromise(): Promise<PromiseHelper<typeof this.data>> {\n        this.promiseHelper = await this.createPromise();\n\n        return this.promiseHelper;\n    }\n\n    private async createPromise(): Promi+
se<PromiseHelper<typeof this.data>> {\n        let resolve: (value: typeof this.data) => void;\n        let reject: (value: unknown) => void;\n\n        const promise = new Promise<typeof this.data>((s, e) => {\n            resolve = s;\n            reje+
ct = e;\n        });\n\n        return new Promise((res) => {\n            res({\n                promise: promise,\n                reject: reject,\n                resolve: resolve\n            });\n        });\n    }\n\n    onConfirm() {\n        this+
.resolve();\n\n        if (this.dialog) {\n            this.dialog.close();\n            this.dialog.destroy();\n        }\n    }\n\n    onCancel() {\n        this.reject();\n\n        if (this.dialog) {\n            this.dialog.close();\n            thi+
s.dialog.destroy();\n        }\n    }\n\n    resolve(data?: typeof this.data) {\n        this.promiseHelper?.resolve(data || this.data);\n    }\n\n    reject(reason?: string) {\n        this.promiseHelper?.reject(reason || \"Cancelled\");\n    }\n\n    d+
estroy() {\n        super.destroy();\n        this.dialog?.destroy();\n        this.promiseHelper?.reject(\"destroy routine\");\n    }\n}\n\nexport default DialogController;\nexport { DialogController };"],"mappings":";;;EAgBA;AACA;AACA;EAFA,MAGMA,gBAAgB+
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","ignoreList":[]}                   