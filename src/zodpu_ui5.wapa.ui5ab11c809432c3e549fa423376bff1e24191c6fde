sap.ui.define(["sap/m/TabContainerItem", "sap/m/VBox", "sap/ui/core/Fragment", "sap/ui/model/json/JSONModel", "./APC.controller", "./BaseController", "./OData.controller"], function (TabContainerItem, VBox, Fragment, JSONModel, __APC, __BaseController, _+
_OData) {                                                                                                                                                                                                                                                      
  "use strict";                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
  function _interopRequireDefault(obj) {                                                                                                                                                                                                                       
    return obj && obj.__esModule && typeof obj.default !== "undefined" ? obj.default : obj;                                                                                                                                                                    
  }                                                                                                                                                                                                                                                            
  const APC = _interopRequireDefault(__APC);                                                                                                                                                                                                                   
  const BaseController = _interopRequireDefault(__BaseController);                                                                                                                                                                                             
  const OData = _interopRequireDefault(__OData);                                                                                                                                                                                                               
  /**                                                                                                                                                                                                                                                          
   * @namespace de.kernich.odpu.controller                                                                                                                                                                                                                     
   */                                                                                                                                                                                                                                                          
  const Main = BaseController.extend("de.kernich.odpu.controller.Main", {                                                                                                                                                                                      
    constructor: function constructor() {                                                                                                                                                                                                                      
      BaseController.prototype.constructor.apply(this, arguments);                                                                                                                                                                                             
      this.controllerMap = new Map();                                                                                                                                                                                                                          
    },                                                                                                                                                                                                                                                         
    onTabContainerAddNewButtonPress: function _onTabContainerAddNewButtonPress() {                                                                                                                                                                             
      void this.handleAddNewButtonPress();                                                                                                                                                                                                                     
    },                                                                                                                                                                                                                                                         
    onTabContainerItemClose: function _onTabContainerItemClose() {},                                                                                                                                                                                           
    onInit: function _onInit() {                                                                                                                                                                                                                               
      BaseController.prototype.onInit.call(this);                                                                                                                                                                                                              
      void this.handleInit();                                                                                                                                                                                                                                  
    },                                                                                                                                                                                                                                                         
    handleInit: async function _handleInit() {                                                                                                                                                                                                                 
      const tabContainer = this.getTabContainer();                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
      // Create tab item immediately for better UX                                                                                                                                                                                                             
      const item = new TabContainerItem({                                                                                                                                                                                                                      
        name: this.getOwnerComponent().getText("app.untitled"),                                                                                                                                                                                                
        additionalText: "ODATA",                                                                                                                                                                                                                               
        modified: false                                                                                                                                                                                                                                        
      });                                                                                                                                                                                                                                                      
      const id = "__" + new Date().getTime().toString();                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
      // Load info and create controller/fragment in parallel                                                                                                                                                                                                  
      const [info, fragment] = await Promise.all([this.loadInfo(), this.createODataControllerAndFragment(id)]);                                                                                                                                                
      const controller = this.getControllerById(id);                                                                                                                                                                                                           
      controller.getView = () => fragment;                                                                                                                                                                                                                     
      item.addContent(new VBox({                                                                                                                                                                                                                               
        items: fragment,                                                                                                                                                                                                                                       
        renderType: "Bare",                                                                                                                                                                                                                                    
        fitContainer: true,                                                                                                                                                                                                                                    
        height: "100%"                                                                                                                                                                                                                                         
      }));                                                                                                                                                                                                                                                     
      tabContainer.addItem(item);                                                                                                                                                                                                                              
      controller.onInit();                                                                                                                                                                                                                                     
      controller.setTitle = title => {                                                                                                                                                                                                                         
        item.setName(title);                                                                                                                                                                                                                                   
      };                                                                                                                                                                                                                                                       
      this.setSelectedItem(item);                                                                                                                                                                                                                              
    },                                                                                                                                                                                                                                                         
    createODataControllerAndFragment: async function _createODataControllerAndFragment(id) {                                                                                                                                                                   
      const controller = new OData(id);                                                                                                                                                                                                                        
      controller.component = this.getOwnerComponent();                                                                                                                                                                                                         
      controller.getOwnerComponent = () => this.getOwnerComponent();                                                                                                                                                                                           
      controller.fragmentId = id;                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
      // Store controller reference for later retrieval                                                                                                                                                                                                        
      this.setControllerById(id, controller);                                                                                                                                                                                                                  
      return Fragment.load({                                                                                                                                                                                                                                   
        name: "de.kernich.odpu.view.fragments.ODATA.Main",                                                                                                                                                                                                     
        controller: controller,                                                                                                                                                                                                                                
        id: id                                                                                                                                                                                                                                                 
      });                                                                                                                                                                                                                                                      
    },                                                                                                                                                                                                                                                         
    setControllerById: function _setControllerById(id, controller) {                                                                                                                                                                                           
      this.controllerMap.set(id, controller);                                                                                                                                                                                                                  
    },                                                                                                                                                                                                                                                         
    getControllerById: function _getControllerById(id) {                                                                                                                                                                                                       
      return this.controllerMap.get(id);                                                                                                                                                                                                                       
    },                                                                                                                                                                                                                                                         
    loadInfo: async function _loadInfo() {                                                                                                                                                                                                                     
      this.setBusy(true);                                                                                                                                                                                                                                      
      try {                                                                                                                                                                                                                                                    
        const info = await this.getOwnerComponent().requests.getInfo();                                                                                                                                                                                        
        this.getOwnerComponent().setModel(new JSONModel(info), "info");                                                                                                                                                                                        
        if (info.UpdateAvailable) {                                                                                                                                                                                                                            
          void this.getOwnerComponent().dialogManager.showUpdateAvailableDialog();                                                                                                                                                                             
        }                                                                                                                                                                                                                                                      
      } finally {                                                                                                                                                                                                                                              
        this.setBusy(false);                                                                                                                                                                                                                                   
      }                                                                                                                                                                                                                                                        
    },                                                                                                                                                                                                                                                         
    setSelectedItem: function _setSelectedItem(item) {                                                                                                                                                                                                         
      while (this.getTabContainer().getSelectedItem() !== item.getId()) {                                                                                                                                                                                      
        this.getTabContainer().setSelectedItem(item);                                                                                                                                                                                                          
      }                                                                                                                                                                                                                                                        
    },                                                                                                                                                                                                                                                         
    handleAddNewButtonPress: async function _handleAddNewButtonPress() {                                                                                                                                                                                       
      const projectType = await this.getOwnerComponent().dialogManager.selectProjectType();                                                                                                                                                                    
      const tabContainer = this.getTabContainer();                                                                                                                                                                                                             
      const item = new TabContainerItem({                                                                                                                                                                                                                      
        name: this.getOwnerComponent().getText("app.untitled"),                                                                                                                                                                                                
        additionalText: projectType,                                                                                                                                                                                                                           
        modified: false                                                                                                                                                                                                                                        
      });                                                                                                                                                                                                                                                      
      const id = "__" + new Date().getTime().toString();                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
      // Add tab immediately for better UX                                                                                                                                                                                                                     
      tabContainer.addItem(item);                                                                                                                                                                                                                              
      try {                                                                                                                                                                                                                                                    
        let fragment;                                                                                                                                                                                                                                          
        let controller;                                                                                                                                                                                                                                        
        if (projectType === "ODATA") {                                                                                                                                                                                                                         
          fragment = await this.createODataControllerAndFragment(id);                                                                                                                                                                                          
          controller = this.getControllerById(id);                                                                                                                                                                                                             
        } else if (projectType === "APC") {                                                                                                                                                                                                                    
          fragment = await this.createAPCControllerAndFragment(id);                                                                                                                                                                                            
          controller = this.getControllerById(id);                                                                                                                                                                                                             
        }                                                                                                                                                                                                                                                      
        controller.getView = () => fragment;                                                                                                                                                                                                                   
        item.addContent(new VBox({                                                                                                                                                                                                                             
          items: fragment,                                                                                                                                                                                                                                     
          renderType: "Bare",                                                                                                                                                                                                                                  
          fitContainer: true,                                                                                                                                                                                                                                  
          height: "100%"                                                                                                                                                                                                                                       
        }));                                                                                                                                                                                                                                                   
        controller.onInit();                                                                                                                                                                                                                                   
        controller.setTitle = title => {                                                                                                                                                                                                                       
          item.setName(title);                                                                                                                                                                                                                                 
        };                                                                                                                                                                                                                                                     
        tabContainer.setSelectedItem(item);                                                                                                                                                                                                                    
      } catch (error) {                                                                                                                                                                                                                                        
        // Remove tab if loading failed                                                                                                                                                                                                                        
        tabContainer.removeItem(item);                                                                                                                                                                                                                         
        throw error;                                                                                                                                                                                                                                           
      }                                                                                                                                                                                                                                                        
    },                                                                                                                                                                                                                                                         
    createAPCControllerAndFragment: async function _createAPCControllerAndFragment(id) {                                                                                                                                                                       
      const controller = new APC(id);                                                                                                                                                                                                                          
      controller.component = this.getOwnerComponent();                                                                                                                                                                                                         
      controller.getOwnerComponent = () => this.getOwnerComponent();                                                                                                                                                                                           
      controller.fragmentId = id;                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
      // Store controller reference for later retrieval                                                                                                                                                                                                        
      this.setControllerById(id, controller);                                                                                                                                                                                                                  
      return Fragment.load({                                                                                                                                                                                                                                   
        name: "de.kernich.odpu.view.fragments.APC.Main",                                                                                                                                                                                                       
        controller: controller,                                                                                                                                                                                                                                
        id: id                                                                                                                                                                                                                                                 
      });                                                                                                                                                                                                                                                      
    },                                                                                                                                                                                                                                                         
    getTabContainer: function _getTabContainer() {                                                                                                                                                                                                             
      return this.getView()?.byId("idTabContainer");                                                                                                                                                                                                           
    }                                                                                                                                                                                                                                                          
  });                                                                                                                                                                                                                                                          
  return Main;                                                                                                                                                                                                                                                 
});                                                                                                                                                                                                                                                            
//# sourceMappingURL=Main-dbg.controller.js.map                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               