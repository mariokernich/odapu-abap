sap.ui.define(["sap/f/Card","sap/f/cards/Header","sap/m/Button","sap/m/Column","sap/m/ColumnListItem","sap/m/HBox","sap/m/Input","sap/m/MessageToast","sap/m/Table","sap/m/Text","sap/m/VBox","sap/ui/core/Renderer","sap/ui/core/ws/SapPcpWebSocket","sap/ui/+
model/json/JSONModel","../util/DialogManager"],function(t,e,n,s,a,i,o,c,r,l,p,d,h,u,w){"use strict";function g(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const f=g(w);const m=t.extend("de.kernich.odpu.control.ApcCard",{renderer+
:d.extend(t),metadata:{properties:{path:{type:"string",defaultValue:""},applicationId:{type:"string",defaultValue:""}},events:{delete:{}}},constructor:function a(c,d){t.prototype.constructor.call(this,c,d);this.apcData={applicationId:"",path:"",running:f+
alse,busy:false};this.setModel(new u(this.apcData,true),"control");const h=new e({title:"{control>/applicationId}",subtitle:"{control>/path}"});this.setHeader(h);const w=new p;this.setBusyIndicatorDelay(0);w.addStyleClass("sapUiSmallMargin");this.table=n+
ew r;this.table.addColumn(new s({header:new l({text:"Event"}),width:"80px"}));this.table.addColumn(new s({header:new l({text:"Data"})}));this.table.addColumn(new s({header:new l({text:"Time"}),width:"80px"}));const g=()=>{this.sendMessage(m.getValue());m+
.setValue("")};const m=new o({placeholder:"Enter message...",enabled:"{control>/running}",width:"100%",submit:g});const y=async()=>{const t=await f.showConfirmationDialog("Are you sure you want to clear the table?");if(t){this.table.destroyItems()}};cons+
t C=async()=>{const t=await f.showConfirmationDialog("Are you sure you want to stop the connection?");if(t){void this.stop()}};const D=new i({justifyContent:"SpaceBetween",alignItems:"Center",items:[new l({text:"Connected: {control>/running}"}),new i({it+
ems:[new n({tooltip:"Connect",icon:"sap-icon://connected",visible:"{= ${control>/running} === false}",press:()=>{void this.start()}}),new n({tooltip:"Disconnect",icon:"sap-icon://disconnected",visible:"{= ${control>/running} === true}",press:()=>{void C(+
)}}),new n({tooltip:"Clear",icon:"sap-icon://clear-all",press:()=>{void y()}}).addStyleClass("sapUiTinyMarginBegin"),new n({type:"Reject",icon:"sap-icon://delete",press:()=>{this.fireDelete()}}).addStyleClass("sapUiTinyMarginBegin")]})]});w.addItem(D);w.+
addItem(this.table);const b=new i({renderType:"Bare",items:[m,new n({text:"Send",enabled:"{control>/running}",press:g}).addStyleClass("sapUiSmallMarginBegin")]});w.addItem(b);this.setContent(w)},start:async function t(){this.setBusy(true);try{this.socket+
=new h(this.apcData.path);this.socket.attachMessage(t=>{const e=t.getParameters().data;let n;if(typeof e==="string"){n=e}else{n=JSON.stringify(e)}this.table.addItem(new a({cells:[new l({text:"Receiving"}),new l({text:n}),new l({text:(new Date).toLocaleTi+
meString()})]}))});await new Promise((t,e)=>{this.socket.attachOpen(()=>{this.setBusy(false);this.apcData.running=true;c.show("connected: "+this.apcData.path);console.log("connected: "+this.apcData.path);t()});this.socket.attachError(t=>{c.show("error: "+
+JSON.stringify(t));console.log("error at "+this.apcData.path+": "+JSON.stringify(t));e(new Error("failed to connect: "+JSON.stringify(t)))})})}finally{this.setBusy(false)}},stop:function t(){this.setBusy(true);this.socket?.close();this.socket.attachClos+
e(()=>{this.setBusy(false);this.apcData.running=false;c.show("disconnected")})},sendMessage:function t(e){this.socket?.send(e);this.table.addItem(new a({cells:[new l({text:"Sending"}),new l({text:e}),new l({text:(new Date).toLocaleTimeString()})]}))},set+
Path:function t(e){this.setProperty("path",e);this.apcData.path=e},setApplicationId:function t(e){this.setProperty("applicationId",e);this.apcData.applicationId=e}});return m});                                                                              
//# sourceMappingURL=ApcCard.js.map                                                                                                                                                                                                                            