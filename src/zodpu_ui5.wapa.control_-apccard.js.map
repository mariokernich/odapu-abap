{"version":3,"file":"ApcCard.js","names":["DialogManager","_interopRequireDefault","__DialogManager","ApcCard","Card","extend","renderer","Renderer","metadata","properties","path","type","defaultValue","applicationId","events","delete","constructor","_co+
nstructor","id","settings","Card.prototype.constructor.call","this","apcData","running","busy","setModel","JSONModel","header","Header","title","subtitle","setHeader","container","VBox","setBusyIndicatorDelay","addStyleClass","table","Table","addColumn",+
"Column","Text","text","width","submitMessage","sendMessage","messageInput","getValue","setValue","Input","placeholder","enabled","submit","clearTable","async","confirmed","showConfirmationDialog","destroyItems","stop","subHeader","HBox","justifyContent"+
,"alignItems","items","Button","tooltip","icon","visible","press","start","fireDelete","addItem","menu","renderType","setContent","_start","setBusy","socket","SapPcpWebSocket","attachMessage","message","body","getParameters","data","JSON","stringify","Co+
lumnListItem","cells","Date","toLocaleTimeString","Promise","resolve","reject","attachOpen","MessageToast","show","console","log","attachError","error","Error","_stop","close","attachClose","_sendMessage","send","setPath","_setPath","setProperty","setApp+
licationId","_setApplicationId"],"sources":["ApcCard.ts"],"sourcesContent":["import Card from \"sap/f/Card\";\nimport Header from \"sap/f/cards/Header\";\nimport Button from \"sap/m/Button\";\nimport Column from \"sap/m/Column\";\nimport ColumnListItem f+
rom \"sap/m/ColumnListItem\";\nimport HBox from \"sap/m/HBox\";\nimport Input from \"sap/m/Input\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport Table from \"sap/m/Table\";\nimport Text from \"sap/m/Text\";\nimport VBox from \"sap/m/VBox\";\+
nimport Renderer from \"sap/ui/core/Renderer\";\nimport SapPcpWebSocket from \"sap/ui/core/ws/SapPcpWebSocket\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport DialogManager from \"../util/DialogManager\";\n\n/**\n * @namespace de.kernic+
h.odpu.control\n */\nexport default class ApcCard extends Card {\n\tstatic readonly metadata = {\n\t\tproperties: {\n\t\t\tpath: {\n\t\t\t\ttype: \"string\",\n\t\t\t\tdefaultValue: \"\",\n\t\t\t},\n\t\t\tapplicationId: {\n\t\t\t\ttype: \"string\",\n\t\t\+
t\tdefaultValue: \"\",\n\t\t\t},\n\t\t},\n\t\tevents: {\n\t\t\tdelete: {},\n\t\t},\n\t};\n\n\tprivate apcData = {\n\t\tapplicationId: \"\",\n\t\tpath: \"\",\n\t\trunning: false,\n\t\tbusy: false,\n\t};\n\n\tprivate table: Table;\n\n\tprivate socket?: Sap+
PcpWebSocket;\n\n\tstatic readonly renderer = Renderer.extend(Card);\n\n\tconstructor(idOrSettings?: string | $ApcCardSettings);\n\tconstructor(id?: string, settings?: $ApcCardSettings);\n\tconstructor(id?: string, settings?: $ApcCardSettings) {\n\t\tsup+
er(id, settings);\n\n\t\tthis.setModel(new JSONModel(this.apcData, true), \"control\");\n\n\t\tconst header = new Header({\n\t\t\ttitle: \"{control>/applicationId}\",\n\t\t\tsubtitle: \"{control>/path}\",\n\t\t});\n\n\t\tthis.setHeader(header);\n\n\t\tco+
nst container = new VBox();\n\t\tthis.setBusyIndicatorDelay(0);\n\t\tcontainer.addStyleClass(\"sapUiSmallMargin\");\n\t\tthis.table = new Table();\n\n\t\tthis.table.addColumn(\n\t\t\tnew Column({\n\t\t\t\theader: new Text({\n\t\t\t\t\ttext: \"Event\",\n\+
t\t\t\t}),\n\t\t\t\twidth: \"80px\",\n\t\t\t})\n\t\t);\n\n\t\tthis.table.addColumn(\n\t\t\tnew Column({\n\t\t\t\theader: new Text({\n\t\t\t\t\ttext: \"Data\",\n\t\t\t\t}),\n\t\t\t})\n\t\t);\n\n\t\tthis.table.addColumn(\n\t\t\tnew Column({\n\t\t\t\theader+
: new Text({\n\t\t\t\t\ttext: \"Time\",\n\t\t\t\t}),\n\t\t\t\twidth: \"80px\",\n\t\t\t})\n\t\t);\n\n\t\tconst submitMessage = () => {\n\t\t\tthis.sendMessage(messageInput.getValue());\n\t\t\tmessageInput.setValue(\"\");\n\t\t};\n\n\t\tconst messageInput +
= new Input({\n\t\t\tplaceholder: \"Enter message...\",\n\t\t\tenabled: \"{control>/running}\",\n\t\t\twidth: \"100%\",\n\t\t\tsubmit: submitMessage,\n\t\t});\n\n\t\tconst clearTable = async () => {\n\t\t\tconst confirmed = await DialogManager.showConfir+
mationDialog(\n\t\t\t\t\"Are you sure you want to clear the table?\"\n\t\t\t);\n\t\t\tif (confirmed) {\n\t\t\t\tthis.table.destroyItems();\n\t\t\t}\n\t\t};\n\n\t\tconst stop = async () => {\n\t\t\tconst confirmed = await DialogManager.showConfirmationDia+
log(\n\t\t\t\t\"Are you sure you want to stop the connection?\"\n\t\t\t);\n\t\t\tif (confirmed) {\n\t\t\t\tvoid this.stop();\n\t\t\t}\n\t\t};\n\n\t\tconst subHeader = new HBox({\n\t\t\tjustifyContent: \"SpaceBetween\",\n\t\t\talignItems: \"Center\",\n\t\+
t\titems: [\n\t\t\t\tnew Text({\n\t\t\t\t\ttext: \"Connected: {control>/running}\",\n\t\t\t\t}),\n\t\t\t\tnew HBox({\n\t\t\t\t\titems: [\n\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\ttooltip: \"Connect\",\n\t\t\t\t\t\t\ticon: \"sap-icon://connected\",\n\t\t\t+
\t\t\t\tvisible: \"{= ${control>/running} === false}\",\n\t\t\t\t\t\t\tpress: () => {\n\t\t\t\t\t\t\t\tvoid this.start();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\ttooltip: \"Disconnect\",\n\t\t\t\t\t\t\ticon: \"sap-icon+
://disconnected\",\n\t\t\t\t\t\t\tvisible: \"{= ${control>/running} === true}\",\n\t\t\t\t\t\t\tpress: () => {\n\t\t\t\t\t\t\t\tvoid stop();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\ttooltip: \"Clear\",\n\t\t\t\t\t\t\tic+
on: \"sap-icon://clear-all\",\n\t\t\t\t\t\t\tpress: () => {\n\t\t\t\t\t\t\t\tvoid clearTable();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMarginBegin\"),\n\t\t\t\t\t\tnew Button({\n\t\t\t\t\t\t\ttype: \"Reject\",\n\t\t\t\t\t\t\ticon: \"s+
ap-icon://delete\",\n\t\t\t\t\t\t\tpress: () => {\n\t\t\t\t\t\t\t\tthis.fireDelete();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}).addStyleClass(\"sapUiTinyMarginBegin\"),\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\tcontainer.addItem(subHeader);\n\t\tconta+
iner.addItem(this.table);\n\n\t\tconst menu = new HBox({\n\t\t\trenderType: \"Bare\",\n\t\t\titems: [\n\t\t\t\tmessageInput,\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: \"Send\",\n\t\t\t\t\tenabled: \"{control>/running}\",\n\t\t\t\t\tpress: submitMessage,\n\t+
\t\t\t}).addStyleClass(\"sapUiSmallMarginBegin\"),\n\t\t\t],\n\t\t});\n\n\t\tcontainer.addItem(menu);\n\n\t\tthis.setContent(container);\n\t}\n\n\tpublic async start() {\n\t\tthis.setBusy(true);\n\n\t\ttry {\n\t\t\tthis.socket = new SapPcpWebSocket(this.+
apcData.path);\n\n\t\t\tthis.socket.attachMessage(\n\t\t\t\t(message: {\n\t\t\t\t\tgetParameters: () => {\n\t\t\t\t\t\tdata: string;\n\t\t\t\t\t\tpcpFields?: object;\n\t\t\t\t\t};\n\t\t\t\t}) => {\n\t\t\t\t\tconst body = message.getParameters().data;\n\t+
\t\t\t\tlet text;\n\n\t\t\t\t\tif (typeof body === \"string\") {\n\t\t\t\t\t\ttext = body;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttext = JSON.stringify(body);\n\t\t\t\t\t}\n\n\t\t\t\t\t//const pcp = message.getParameters().pcpFields;\n\t\t\t\t\tthis.table.addI+
tem(\n\t\t\t\t\t\tnew ColumnListItem({\n\t\t\t\t\t\t\tcells: [\n\t\t\t\t\t\t\t\tnew Text({\n\t\t\t\t\t\t\t\t\ttext: \"Receiving\",\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tnew Text({\n\t\t\t\t\t\t\t\t\ttext: text,\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tnew T+
ext({\n\t\t\t\t\t\t\t\t\ttext: new Date().toLocaleTimeString(),\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tawait new Promise<void>((resolve, reject) => {\n\t\t\t\tthis.socket.attachOpen(() => {\n\t\+
t\t\t\tthis.setBusy(false);\n\t\t\t\t\tthis.apcData.running = true;\n\t\t\t\t\tMessageToast.show(\"connected: \" + this.apcData.path);\n\t\t\t\t\tconsole.log(\"connected: \" + this.apcData.path);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t\tthis.socket.at+
tachError((error: Error) => {\n\t\t\t\t\tMessageToast.show(\"error: \" + JSON.stringify(error));\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t\"error at \" + this.apcData.path + \": \" + JSON.stringify(error)\n\t\t\t\t\t);\n\t\t\t\t\treject(new Error(\"failed to+
 connect: \" + JSON.stringify(error)));\n\t\t\t\t});\n\t\t\t});\n\t\t} finally {\n\t\t\tthis.setBusy(false);\n\t\t}\n\t}\n\n\tpublic stop() {\n\t\tthis.setBusy(true);\n\t\tthis.socket?.close();\n\t\tthis.socket.attachClose(() => {\n\t\t\tthis.setBusy(fal+
se);\n\t\t\tthis.apcData.running = false;\n\t\t\tMessageToast.show(\"disconnected\");\n\t\t});\n\t}\n\n\tpublic sendMessage(message: string) {\n\t\tthis.socket?.send(message);\n\t\tthis.table.addItem(\n\t\t\tnew ColumnListItem({\n\t\t\t\tcells: [\n\t\t\t+
\t\tnew Text({\n\t\t\t\t\t\ttext: \"Sending\",\n\t\t\t\t\t}),\n\t\t\t\t\tnew Text({\n\t\t\t\t\t\ttext: message,\n\t\t\t\t\t}),\n\t\t\t\t\tnew Text({\n\t\t\t\t\t\ttext: new Date().toLocaleTimeString(),\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t})\n\t\t);\n\t}\n\n+
\tpublic setPath(path: string) {\n\t\tthis.setProperty(\"path\", path);\n\t\tthis.apcData.path = path;\n\t}\n\n\tpublic setApplicationId(applicationId: string) {\n\t\tthis.setProperty(\"applicationId\", applicationId);\n\t\tthis.apcData.applicationId = a+
pplicationId;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}                                                                                                                                                                    